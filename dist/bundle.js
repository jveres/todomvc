!function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(31)},function(t,e){t.exports=function(t,e){return"string"==typeof t?t:t+e}},function(t,e){var n="";if("undefined"!=typeof document){var o=document.documentElement||document.createElement("div");n=null!=o.style.animation?"":"-webkit-"}t.exports=n},function(t,e,n){function o(t){return function(e){return null==e?void 0:e[t]}}function r(t){return null!=t&&a(y(t))}function i(t,e){return t="number"==typeof t||f.test(t)?+t:-1,e=null==e?b:e,t>-1&&t%1==0&&e>t}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&b>=t}function s(t){for(var e=c(t),n=e.length,o=n&&t.length,r=!!o&&a(o)&&(p(t)||h(t)),s=-1,u=[];++s<n;){var l=e[s];(r&&i(l,o)||m.call(t,l))&&u.push(l)}return u}function u(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function c(t){if(null==t)return[];u(t)||(t=Object(t));var e=t.length;e=e&&a(e)&&(p(t)||h(t))&&e||0;for(var n=t.constructor,o=-1,r="function"==typeof n&&n.prototype===t,s=Array(e),c=e>0;++o<e;)s[o]=o+"";for(var l in t)c&&i(l,e)||"constructor"==l&&(r||!m.call(t,l))||s.push(l);return s}var l=n(20),h=n(21),p=n(22),f=/^\d+$/,d=Object.prototype,m=d.hasOwnProperty,g=l(Object,"keys"),b=9007199254740991,y=o("length"),v=g?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&r(t)?s(t):u(t)?g(t):[]}:s;t.exports=v},function(t,e){function n(t,e){if("function"!=typeof t)throw new TypeError(o);return e=r(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,o=-1,i=r(n.length-e,0),a=Array(i);++o<i;)a[o]=n[e+o];switch(e){case 0:return t.call(this,a);case 1:return t.call(this,n[0],a);case 2:return t.call(this,n[0],n[1],a)}var s=Array(e+1);for(o=-1;++o<e;)s[o]=n[o];return s[e]=a,t.apply(this,s)}}var o="Expected a function",r=Math.max;t.exports=n},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e,n){function o(t,e){for(var n=0;n<t.length;n++){var o=t[n],r=h[o.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](o.parts[i]);for(;i<o.parts.length;i++)r.parts.push(s(o.parts[i],e))}else{for(var a=[],i=0;i<o.parts.length;i++)a.push(s(o.parts[i],e));h[o.id]={id:o.id,refs:1,parts:a}}}}function r(t){for(var e=[],n={},o=0;o<t.length;o++){var r=t[o],i=r[0],a=r[1],s=r[2],u=r[3],c={css:a,media:s,sourceMap:u};n[i]?n[i].parts.push(c):e.push(n[i]={id:i,parts:[c]})}return e}function i(){var t=document.createElement("style"),e=d();return t.type="text/css",e.appendChild(t),t}function a(){var t=document.createElement("link"),e=d();return t.rel="stylesheet",e.appendChild(t),t}function s(t,e){var n,o,r;if(e.singleton){var s=g++;n=m||(m=i()),o=u.bind(null,n,s,!1),r=u.bind(null,n,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=a(),o=l.bind(null,n),r=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=i(),o=c.bind(null,n),r=function(){n.parentNode.removeChild(n)});return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else r()}}function u(t,e,n,o){var r=n?"":o.css;if(t.styleSheet)t.styleSheet.cssText=b(e,r);else{var i=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function c(t,e){var n=e.css,o=e.media;if(e.sourceMap,o&&t.setAttribute("media",o),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function l(t,e){var n=e.css,o=(e.media,e.sourceMap);o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(r),i&&URL.revokeObjectURL(i)}var h={},p=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},f=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),d=p(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,g=0;t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=f());var n=r(t);return o(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var s=n[a],u=h[s.id];u.refs--,i.push(u)}if(t){var c=r(t);o(c,e)}for(var a=0;a<i.length;a++){var u=i[a];if(0===u.refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete h[u.id]}}}};var b=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){function o(t,e,n){for(var o=n&&n.clearTransforms===!0,i=0,a=t.length;a>i;i++)o&&r(t[i]),t[i].style[h]=e}function r(t){t.style.transform="",t.style[d]=""}function i(t){t.style[h]="",t.style.animation=""}function a(t,e){for(var n=e&&e.clearAnimations===!0,o=0,r=t.length;r>o;o++)t[o].style[d]=getComputedStyle(t[o])[d],n&&i(t[o])}var s=n(13),u=n(25),c=n(12),l=n(10),h=n(8),p=n(23),f=n(1);if("undefined"!=typeof window)var d=n(26);var m={},g={duration:1e3,fillMode:"both",easing:"ease",iterations:1,delay:0,direction:"normal",resetWhenDone:!1,clearTransformsBeforeStart:!1};e.hasAnimation=function(t){return m.hasOwnProperty(t)},e.runAnimation=p(function(t,e,n){if(n||(n=function(){}),"string"==typeof e&&(e={name:e}),t.length||(t=[t]),!e.name)return n(Error("must supply animation name"));var r=m[e.name];if(!r)return n(Error('no animation named "'+e.name+'" exists'));e=s(e,r.presets,g);var i=function(){return u.remove(t[0],"AnimationEnd",i),e.resetWhenDone&&a(t,{clearAnimations:!0}),n(null,t)};u.add(t[0],"AnimationEnd",i);var c=[e.name,f(e.duration,"ms"),e.easing,e.iterations,f(e.delay,"ms"),e.direction,e.fillMode];o(t,c.join(" "),{clearTransforms:e.clearTransformsBeforeStart})}),e.unregisterAnimation=function(t){if(e.hasAnimation(t)){var n=m[t].el;n.parentNode.removeChild(n),delete m[t]}},e.getAnimationCSS=l,e.registerAnimation=function(t){e.unregisterAnimation(t.name);var n=c(e.getAnimationCSS(t.name,t.animation));n.setAttribute("data-name",t.name),m[t.name]={el:n,presets:t.presets||{}}}},function(t,e,n){var o=n(2);t.exports=o?"webkitAnimation":"animation"},function(t,e,n){function o(t,e){return t.hasOwnProperty(e)?t[e]:0}var r=n(1);t.exports=function(t){var e=[];return Array.isArray(t)?e=2===t.length?e.concat(t,0):t:(e.push(o(t,"x")),e.push(o(t,"y")),e.push(o(t,"z"))),e=e.map(function(t){return r(t,"px")}),"translate3d("+e.join(",")+")"}},function(t,e,n){function o(t,e){return"number"==typeof t?t+="%":"string"==typeof t&&-1===t.indexOf("%")&&(t+="%"),t+"{"+r(e)+"}"}var r=n(11),i=n(2);t.exports=function(t,e){var n="@"+i+"keyframes "+t+"{";if(Array.isArray(e))n+=e.map(function(t,n){var r;return r=n?n/(e.length-1)*100:0,o(r,t)}).join("");else for(var r in e)n+=o(r,e[r]);return n+="}"}},function(t,e,n){var o=n(9),r=n(2),i=n(1),a={scale:function(t){return"scale("+t+")"},rotate:function(t){return"rotate("+i(t,"deg")+")"},translate:function(t){return o(t)},transform:function(t){return t}};t.exports=function(t){if(Array.isArray(t))return r+"transform:"+o(t);var e=[],n=[];if("object"==typeof t)for(var i in t)a[i]?e.push(a[i](t[i])):n.push(i+":"+t[i]);return n.push(r+"transform:"+e.join("")),n.join(";")}},function(t,e){function n(t,e){e||(e=document);var n=e.head||e.getElementsByTagName("head")[0];if(!n){n=e.createElement("head");var o=e.body||e.getElementsByTagName("body")[0];o?o.parentNode.insertBefore(n,o):e.documentElement.appendChild(n)}var r=e.createElement("style");return r.type="text/css",r.styleSheet?r.styleSheet.cssText=t:r.appendChild(e.createTextNode(t)),n.appendChild(r),r}t.exports=n},function(t,e,n){function o(t,e){return void 0===t?e:t}function r(t,e){return a(function(n){var o=n[0];return null==o?o:(n.push(e),t.apply(void 0,n))})}var i=n(14),a=n(4),s=r(i,o);t.exports=s},function(t,e,n){function o(t,e,n){for(var o=-1,r=a(e),i=r.length;++o<i;){var s=r[o],u=t[s],c=n(u,e[s],s,t,e);(c===c?c===u:u!==u)&&(void 0!==u||s in t)||(t[s]=c)}return t}var r=n(15),i=n(17),a=n(3),s=i(function(t,e,n){return n?o(t,e,n):r(t,e)});t.exports=s},function(t,e,n){function o(t,e){return null==e?t:r(e,i(e),t)}var r=n(16),i=n(3);t.exports=o},function(t,e){function n(t,e,n){n||(n={});for(var o=-1,r=e.length;++o<r;){var i=e[o];n[i]=t[i]}return n}t.exports=n},function(t,e,n){function o(t){return a(function(e,n){var o=-1,a=null==e?0:n.length,s=a>2?n[a-2]:void 0,u=a>2?n[2]:void 0,c=a>1?n[a-1]:void 0;for("function"==typeof s?(s=r(s,c,5),a-=2):(s="function"==typeof c?c:void 0,a-=s?1:0),u&&i(n[0],n[1],u)&&(s=3>a?void 0:s,a=1);++o<a;){var l=n[o];l&&t(e,l,s)}return e})}var r=n(18),i=n(19),a=n(4);t.exports=o},function(t,e){function n(t,e,n){if("function"!=typeof t)return o;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,o,r){return t.call(e,n,o,r)};case 4:return function(n,o,r,i){return t.call(e,n,o,r,i)};case 5:return function(n,o,r,i,a){return t.call(e,n,o,r,i,a)}}return function(){return t.apply(e,arguments)}}function o(t){return t}t.exports=n},function(t,e){function n(t){return function(e){return null==e?void 0:e[t]}}function o(t){return null!=t&&a(l(t))}function r(t,e){return t="number"==typeof t||u.test(t)?+t:-1,e=null==e?c:e,t>-1&&t%1==0&&e>t}function i(t,e,n){if(!s(n))return!1;var i=typeof e;if("number"==i?o(n)&&r(e,n.length):"string"==i&&e in n){var a=n[e];return t===t?t===a:a!==a}return!1}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&c>=t}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var u=/^\d+$/,c=9007199254740991,l=n("length");t.exports=i},function(t,e){function n(t){return!!t&&"object"==typeof t}function o(t,e){var n=null==t?void 0:t[e];return a(n)?n:void 0}function r(t){return i(t)&&p.call(t)==s}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){return null==t?!1:r(t)?f.test(l.call(t)):n(t)&&u.test(t)}var s="[object Function]",u=/^\[object .+?Constructor\]$/,c=Object.prototype,l=Function.prototype.toString,h=c.hasOwnProperty,p=c.toString,f=RegExp("^"+l.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=o},function(t,e){function n(t){return!!t&&"object"==typeof t}function o(t){return function(e){return null==e?void 0:e[t]}}function r(t){return null!=t&&i(h(t))}function i(t){return"number"==typeof t&&t>-1&&t%1==0&&l>=t}function a(t){return n(t)&&r(t)&&u.call(t,"callee")&&!c.call(t,"callee")}var s=Object.prototype,u=s.hasOwnProperty,c=s.propertyIsEnumerable,l=9007199254740991,h=o("length");t.exports=a},function(t,e){function n(t){return!!t&&"object"==typeof t}function o(t,e){var n=null==t?void 0:t[e];return s(n)?n:void 0}function r(t){return"number"==typeof t&&t>-1&&t%1==0&&b>=t}function i(t){return a(t)&&d.call(t)==c}function a(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){return null==t?!1:i(t)?m.test(p.call(t)):n(t)&&l.test(t)}var u="[object Array]",c="[object Function]",l=/^\[object .+?Constructor\]$/,h=Object.prototype,p=Function.prototype.toString,f=h.hasOwnProperty,d=h.toString,m=RegExp("^"+p.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=o(Array,"isArray"),b=9007199254740991,y=g||function(t){return n(t)&&r(t.length)&&d.call(t)==u};t.exports=y},function(t,e,n){(function(e){var o,r=n(24),i=Array.prototype.slice;"undefined"!=typeof window&&(o=window.Promise),"undefined"!=typeof e&&(o=e.Promise),t.exports=function(t){return o?function(){var e=i.call(arguments),n=this;return r(e.slice(-1))?t.apply(n,e):new o(function(o,r){e.push(function(t,e){t?r(t):o.apply(this,i.call(arguments,1))}),t.apply(n,e)})}:t}}).call(e,function(){return this}())},function(t,e){function n(t){var e=o.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}t.exports=n;var o=Object.prototype.toString},function(t,e){t.exports=function(){"use strict";function t(t,e){if(!t)throw new Error(e)}function e(){}var n=["webkit","moz","MS","o",""];return{add:function(o,r,i){i=i||e,t(o,"element is required"),t(r,"type is required");for(var a=0;a<n.length;a++)n[a]||(r=r.toLowerCase()),o.addEventListener(n[a]+r,i,!1)},remove:function(o,r,i){i=i||e,t(o,"element is required"),t(r,"type is required");for(var a=0;a<n.length;a++)n[a]||(r=r.toLowerCase()),o.removeEventListener(n[a]+r,i,!1)}}}()},function(t,e){for(var n,o=["webkitTransform","MozTransform","msTransform","OTransform","transform"],r=document.createElement("p"),i=0;i<o.length;i++)if(n=o[i],null!=r.style[n]){t.exports=n;break}},function(t,e,n){e=t.exports=n(5)(),e.push([t.id,"#heartbox{display:inline-block;opacity:.8}.heart{position:absolute;opacity:0;padding-top:4px}",""])},function(t,e,n){e=t.exports=n(5)(),e.push([t.id,'a,input{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;-webkit-user-drag:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}input{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}hr{margin:20px 0;border:0;border-top:1px dashed #c5c5c5;border-bottom:1px dashed #f7f7f7}button{margin:0;padding:0;border:0;background:none;font-size:100%;vertical-align:baseline;font-family:inherit;font-weight:inherit;color:inherit;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-smoothing:antialiased}body{font:14px Helvetica Neue,Helvetica,Arial,sans-serif;line-height:1.4em;background:#fff;color:#4d4d4d;min-width:230px;max-width:550px;margin:0 auto;font-smoothing:antialiased;font-weight:300;padding:30px}button,input[type=checkbox]{outline:none}.header{position:relative}.header h1{display:inline-block;color:#5dc2af}.edit,.new-todo{position:relative;margin:0;width:100%;font-size:24px;font-family:inherit;font-weight:inherit;line-height:1.4em;border:0;outline:none;color:inherit;padding:6px;border:1px solid #999;box-shadow:inset 0 -1px 5px 0 rgba(0,0,0,.2);box-sizing:border-box;font-smoothing:antialiased}.new-todo{padding:16px 16px 16px 60px;border:none;background:rgba(0,0,0,.003);box-shadow:inset 0 -2px 1px rgba(0,0,0,.03)}.main{position:relative;z-index:2;border-top:1px solid #e6e6e6}label[for=toggle-all]{display:none}.toggle-all{position:absolute;top:-55px;left:-12px;width:60px;height:34px;text-align:center;border:none}.toggle-all:before{content:\'\\276F\';font-size:22px;color:#e6e6e6;padding:10px 27px}.toggle-all:checked:before{color:#737373}.todo-list{margin:0;padding:0;list-style:none;position:relative}.todo-list,.todo-list li{width:100%;max-width:100%}.todo-list li{opacity:0;font-size:24px;border-bottom:1px solid #ededed;display:block;position:absolute;will-change:opacity,transform;-webkit-transition:opacity .3s ease-out;transition:opacity .3s ease-out}.todo-list li:last-child{border-bottom:none}.todo-list li.editing{border-bottom:none;padding:0}.todo-list li.editing .edit{display:block;width:506px;padding:13px 17px 12px;margin:0 0 0 43px}.todo-list li.editing .view{display:none}.todo-list li .toggle{text-align:center;width:40px;height:auto;position:absolute;top:0;bottom:0;margin:auto 0;border:none;-webkit-appearance:none;-moz-appearance:none;appearance:none}.todo-list li .toggle:after{content:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-10 -18 100 135"><circle cx="50" cy="50" r="50" fill="none" stroke="#ededed" stroke-width="3"/></svg>\')}.todo-list li .toggle:checked:after{content:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-10 -18 100 135"><circle cx="50" cy="50" r="50" fill="none" stroke="#bddad5" stroke-width="3"/><path fill="#5dc2af" d="M72 25L42 71 27 56l-4 4 20 20 34-52z"/></svg>\')}.todo-list li label{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;padding:15px 60px 15px 15px;margin-left:45px;display:block;max-width:80%;line-height:1.2;-webkit-transition:color .3s;transition:color .3s;-webkit-transform-origin:0 50%;transform-origin:0 50%}.todo-list li.completed label{color:#d9d9d9;text-decoration:line-through}.todo-list li .destroy{display:none;position:absolute;top:0;right:10px;bottom:0;width:40px;height:40px;margin:auto 0;font-size:30px;color:#cc9a9a;margin-bottom:11px;-webkit-transition:color .3s ease-out;transition:color .3s ease-out}.todo-list li .destroy:hover{color:#af5b5e}.todo-list li .destroy:after{content:\'\\D7\'}.todo-list li:hover .destroy{display:block}.todo-list li .edit{display:none}.todo-list li.editing:last-child{margin-bottom:-1px}.footer{color:#777;padding:10px 15px;height:20px;text-align:center;border-top:1px solid #e6e6e6;margin-bottom:40px;position:relative;opacity:0;will-change:opacity,transform;-webkit-transition:opacity .3s ease-out;transition:opacity .3s ease-out}.todo-count{float:left;text-align:left}.todo-count strong{font-weight:300}.filters{margin:0;padding:0;list-style:none;position:absolute;right:0;left:0}.filters li{display:inline}.filters li a{color:inherit;margin:3px;padding:3px 7px;text-decoration:none;border:1px solid transparent;border-radius:3px}.filters li a.selected,.filters li a:hover{border-color:rgba(175,47,47,.1)}.filters li a.selected{border-color:rgba(175,47,47,.2)}.clear-completed,html .clear-completed:active{float:right;line-height:20px;text-decoration:none;cursor:pointer;position:relative}.clear-completed:hover{text-decoration:underline}@media screen and (-webkit-min-device-pixel-ratio:0){.todo-list li .toggle,.toggle-all{background:none}.todo-list li .toggle{height:40px}.toggle-all{-webkit-transform:rotate(90deg);transform:rotate(90deg);-webkit-appearance:none;-moz-appearance:none;appearance:none}}@media (max-width:430px){.footer{height:50px}.filters{bottom:10px}}',""])},function(t,e){!function(){function e(t){var n=this;return e.is(n)?e.is(t)?n:n.opt(t):new e(t)}!function(t){!function(t){t.fns={is:function(t){return t instanceof Function?!0:!1}},t.bi={is:function(t){return t instanceof Boolean||"boolean"==typeof t?!0:!1}},t.num={is:function(e){return!t.list.is(e)&&(1/0===e||e-parseFloat(e)+1>=0)}},t.text={is:function(t){return"string"==typeof t?!0:!1}},t.text.ify=function(e){return t.text.is(e)?e:"undefined"!=typeof JSON?JSON.stringify(e):e&&e.toString?e.toString():e},t.text.random=function(t,e){var n="";for(t=t||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t>0;)n+=e.charAt(Math.floor(Math.random()*e.length)),t--;return n},t.text.match=function(e,n){function o(t,e){for(var n,o=-1,r=0;n=e[r++];)if(!~(o=t.indexOf(n,o+1)))return!1;return!0}var r=!1;if(e=e||"",n=n||{},t.obj.has(n,"="))return e===n["="];if(t.obj.has(n,"*")){if(e.slice(0,n["*"].length)!==n["*"])return!1;r=!0,e=e.slice(n["*"].length)}if(t.obj.has(n,"&")){if(e.slice(-n["&"].length)!==n["&"])return!1;r=!0}if(t.obj.has(n,"+")){if(!(e.indexOf(n["+"])>=0))return!1;r=!0}if(t.obj.has(n,"-")){if(!(e.indexOf(n["-"])<0))return!1;r=!0}if(t.obj.has(n,">")){if(!(e>n[">"]))return!1;r=!0}if(t.obj.has(n,"<")){if(!(e<n["<"]))return!1;r=!0}if(t.obj.has(n,"?")){if(!o(e,n["?"]))return!1;r=!0}return r},t.list={is:function(t){return t instanceof Array?!0:!1}},t.list.slit=Array.prototype.slice,t.list.sort=function(t){return function(e,n){return e&&n?(e=e[t],n=n[t],n>e?-1:e>n?1:0):0}},t.list.map=function(e,n,o){return t.obj.map(e,n,o)},t.list.index=1,t.obj={is:function(t){return t&&t.constructor?t.constructor===Object?!0:!t.constructor.call||t.constructor.toString().match(/\[native\ code\]/)?!1:!0:!1}},t.obj.put=function(t,e,n){return(t||{})[e]=n,t},t.obj.del=function(t,e){return t?(t[e]=null,delete t[e],!0):void 0},t.obj.ify=function(e){if(t.obj.is(e))return e;try{e=JSON.parse(e)}catch(n){e={}}return e},t.obj.copy=function(t){return t?JSON.parse(JSON.stringify(t)):t},t.obj.as=function(t,e,n){return t[e]=t[e]||(arguments.length>=3?n:{})},t.obj.has=function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)},t.obj.empty=function(e,n){return e&&t.obj.map(e,function(e,o){return n&&(o===n||t.obj.is(n)&&t.obj.has(n,o))?void 0:o?!0:void 0})?!1:!0},t.obj.map=function(e,n,o){var r,i,a,s,u,c,l=0,h=0,p=t.fns.is(n),f=function(t,e){return 2===arguments.length?(s=s||{},void(s[t]=e)):(s=s||[],void s.push(t))};if(Object.keys&&t.obj.is(e)&&(u=Object.keys(e),c=!0),t.list.is(e)||u){for(i=(u||e).length;i>l;l++)if(h=l+t.list.index,p){if(a=c?n.call(o||this,e[u[l]],u[l],f):n.call(o||this,e[l],h,f),a!==r)return a}else if(n===e[c?u[l]:l])return u?u[l]:h}else for(l in e)if(p){if(t.obj.has(e,l)&&(a=o?n.call(o,e[l],l,f):n(e[l],l,f),a!==r))return a}else if(n===e[l])return l;return p?s:t.list.index?0:-1},t.time={},t.time.is=function(t){return t?t instanceof Date:+(new Date).getTime()},t.time.now=function(e){return((e=e||t.time.is())>(t.time.now.last||-(1/0))?t.time.now.last=e:t.time.now(e+1))+(t.time.now.drift||0)}}(t),function(t){function e(){}e.create=function(){var e=function(t){return e.event.e=t,e.event.s[t]=e.event.s[t]||[],e};return e.emit=function(n){var o=e.event.e,r=e.event.s[o],i=arguments,a=i.length;t.list.map(r,function(t,e){return t.fn?1===a?void t.fn(n):void t.fn.apply(t,i):void r.splice(e-1,0)}),r.length||delete e.event.s[o]},e.event=function(t,o){var r=e.event.s[e.event.e];if(r){var i={fn:t,i:o||0,off:function(){return!(i.fn=!1)}};return r.push(i),o?r.sort(n):o,i}},e.event.s={},e};var n=t.list.sort("i");t.on=e.create(),t.on.create=e.create}(t),function(t){var e=function(t,n){e.waiting.push({when:t,event:n||function(){}}),e.soonest<t||e.set(t)};e.waiting=[],e.soonest=1/0,e.sort=t.list.sort("when"),e.set=function(n){if(!(1/0<=(e.soonest=n))){var o=t.time.now();n=o>=n?0:n-o,clearTimeout(e.id),e.id=setTimeout(e.check,n)}},e.check=function(){var n=t.time.now(),o=1/0;e.waiting.sort(e.sort),e.waiting=t.list.map(e.waiting,function(e,r,i){e&&(e.when<=n?t.fns.is(e.event)&&setTimeout(function(){e.event()},0):(o=o<e.when?o:e.when,i(e)))})||[],e.set(o)},t.schedule=e}(t)}(e),function(t){t.version=.3,t._={meta:"_",soul:"#",field:".",state:">"},t.is=function(e){return e instanceof t?!0:!1},t.is.val=function(e){return null===e?!0:e===1/0?!1:t.bi.is(e)||t.num.is(e)||t.text.is(e)?!0:t.is.rel(e)||!1},t.is.val.as=function(e){return t.is.val(e)?e:null},t.is.rel=function(e){if(t.obj.is(e)){var n;if(t.obj.map(e,function(e,o){return n?n=!1:o==t._.soul&&t.text.is(e)?void(n=e):n=!1}),n)return n}return!1},t.is.rel.ify=function(e,n){return t.obj.as(n={},t._.soul,e),n},t.is.node=function(e,n,o){var r;return t.obj.is(e)&&(r=t.is.node.soul(e))?!t.obj.map(e,function(r,i){return i!=t._.meta?t.is.val(r)?void(n&&n.call(o,r,i,e)):!0:void 0}):!1},t.is.node.ify=function(e,n,o,r){return e=t.is.node.soul.ify(e,n,r),t.obj.map(e,function(n,r){t._.meta!==r&&t.is.node.state.ify([e],r,n,o=o||t.time.now())}),e},t.is.node.soul=function(e,n){return e&&e._&&e._[n||t._.soul]||!1},t.is.node.soul.ify=function(e,n,o){return e=e||{},e._=e._||{},e._[t._.soul]=o?n:e._[t._.soul]||n||t.text.random(),e},t.is.node.state=function(e,n){return n&&e&&e._&&e._[t._.state]&&e._[t._.state][n]||!1},t.is.node.state.ify=function(e,n,o,r){var i,e=e.reverse(),a=e[0];t.list.map(e,function(e,s){e=e||{},i!==o&&t.is.val(o)&&(e[n]=o),e._=e._||{},e=e._[t._.state]=e._[t._.state]||{},(s=a._[t._.state][n])&&(e[n]=s),t.num.is(r)&&(e[n]=r)})},t.is.graph=function(e,n,o,r){var i=!1;return t.obj.is(e)?!t.obj.map(e,function(e,a){return e&&a===t.is.node.soul(e)&&t.is.node(e,o)?((n||function(){}).call(r,e,a,function(n){n&&t.is.node(e,n,r)}),void(i=!0)):!0})&&i:!1},t.is.graph.ify=function(e){var n;if(n=t.is.node.soul(e)){var o={};return o[n]=e,o}},t.HAM=function(t,e,n,o,r){if(e>t)return{defer:!0};if(n>e)return{historical:!0};if(e>n)return{converge:!0,incoming:!0};if(e===n){if(o===r)return{state:!0};if(String(o)<String(r))return{converge:!0,current:!0};if(String(r)<String(o))return{converge:!0,incoming:!0}}return{err:"you have not properly handled recursion through your data or filtered it as JSON"}},t.union=function(e,n,o,r){function i(n){t.on("operating").emit(e,n)}var r=r||t.obj.is(o)?o:{},a={graph:e.__.graph,count:0};return a.cb=function(){o=t.fns.is(o)?o()&&null:null},a.graph||(a.err={err:t.log("No graph!")}),n||(a.err={err:t.log("No data to merge!")}),(a.soul=t.is.node.soul(n))&&(n=t.is.graph.ify(n)),!t.is.graph(n,null,function(e,n,o){var r;return(r=(o||{})[t._.meta])&&(r=r[t._.state])&&t.num.is(r[n])?void 0:a.err={err:t.log("No state on '"+n+"'!")}})||a.err?(a.err=a.err||{err:t.log("Invalid graph!",n)},a):(function(n,o){var o=t.obj.map(o,function(t,e,n){n(t)}).sort(function(e,o){var r=t.is.node.soul(e);return n[r]?1:0});a.count+=1,a.err=t.list.map(o,function(o,s){if(s=t.is.node.soul(o),!s)return{err:t.log("Soul missing or mismatching!")};a.count+=1;var u=n[s];u||(n[s]=u=t.is.node.ify({},s)),t.union.HAM(u,o,function(n,r,i,a){t.on("historical").emit(e,{soul:s,field:r,value:i,state:a,change:o}),e.__.on("historical").emit({soul:s,field:r,change:o})},function(e,n,r,a){if(e){var u=t.is.node.soul.ify({},s);n&&t.is.node.state.ify([e,u,o],n,r),i({soul:s,field:n,value:r,state:a,change:u})}},function(t,e,n){})(function(){i({soul:s,change:o}),r.soul&&r.soul(s),(a.count-=1)||a.cb()})}),a.count-=1}(a.graph,n),a.count||a.cb(),a)},t.union.ify=function(e,n,o,r){if(e&&(e=e.__&&e.__.graph?e.__.graph:e),t.text.is(n)){if(!e||!e[n])return t.is.node.ify({},n);n=e[n]}var i=t.is.node.soul.ify({},t.is.node.soul(n)),n=t.is.graph.ify(n)||n;return t.is.graph(n,null,function(o,r){function a(e,n,o){t.is.node.state.ify(e,n,o)}var s;t.is.rel(o)&&(s=e?e[r]||n[r]:n[r]),t.union.HAM(i,s,function(){},function(t,e,n){a([i,s],e,n)},function(){})(function(t){t&&a([i],r,o)})})?i:void 0},t.union.HAM=function(e,o,r,i,a){return a.max=-(1/0),i.end=!0,o=o||{},e=e||{},t.obj.map(o._,function(n,o){t._.state!==o&&t._.soul!==o&&(e._[o]=n)}),t.is.node(o,function s(u,c){i.end=!1;var l,h={incoming:{},current:{}};return h.drift=t.time.now(),h.incoming.value=t.is.rel(u)||u,h.current.value=t.is.rel(e[c])||e[c],h.incoming.state=t.num.is(h.tmp=((o._||{})[t._.state]||{})[c])?h.tmp:-(1/0),h.current.state=t.num.is(h.tmp=((e._||{})[t._.state]||{})[c])?h.tmp:-(1/0),a.max=h.incoming.state>a.max?h.incoming.state:a.max,l=t.HAM(h.drift,h.incoming.state,h.current.state,h.incoming.value,h.current.value),l.err?void n.console.log(".!HYPOTHETICAL AMNESIA MACHINE ERR!.",l.err):l.state||l.historical||l.current?void r.call(l,e,c,u,h.incoming.state):l.incoming?void i.call(l,e,c,u,h.incoming.state):void(l.defer&&(a.wait=!0,a.call(l,e,c,u,h.incoming.state),t.schedule(h.incoming.state,function(){s(u,c),h.incoming.state===a.max&&(a.last||function(){})()})))})?(i.end&&i.call({},e),function(t){a.last=t||function(){},a.wait||a.last()}):function(t){t&&t({err:"Not a node!"})}},t.on.at=function(e){var n=function(t){return n.e=t,n};return n.emit=function(o){return o.soul&&(o.hash=t.on.at.hash(o),t.obj.as(n.mem,n.e)[o.hash]=o),n.all.cb&&n.all.cb(o,n.e),e(n.e).emit(o),{chain:function(t){return t&&t._&&t._.at?t._.at(n.e).emit(o):void 0}}},n.only=function(t){return n.only.cb?void 0:n.event(n.only.cb=t)},n.all=function(e){n.all.cb=e,t.obj.map(n.mem,function(n,o){t.obj.map(n,function(t,n){e(t,o)})})},n.event=function(o,r){return r=e(n.e).event(o,r),t.obj.map(n.mem[n.e],function(t){r.stat={first:!0},o.call(r,t)}),r.stat={},r},n.map=function(t,e){return n.event(t,e)},n.mem={},n},t.on.at.hash=function(t){return t.at&&t.at.soul?t.at.soul+(t.at.field||""):t.soul+(t.field||"")},t.on.at.copy=function(e){return t.obj.del(e,"hash"),t.obj.map(e,function(t,e,n){n(e,t)})}}(e),function(t){t.chain=t.prototype,t.chain.opt=function(e,n){e=e||{};var o=this,r=o.__&&o.__.gun?o.__.gun:(o._=o.__={gun:o}).gun.chain();return r.__.by=r.__.by||function(t){return o.__.by[t]=o.__.by[t]||{}},r.__.graph=r.__.graph||{},r.__.opt=r.__.opt||{},r.__.opt.wire=r.__.opt.wire||{},t.text.is(e)&&(e={peers:e}),t.list.is(e)&&(e={peers:e}),t.text.is(e.peers)&&(e.peers=[e.peers]),t.list.is(e.peers)&&(e.peers=t.obj.map(e.peers,function(t,e,n){n(t,{})})),r.__.opt.peers=e.peers||o.__.opt.peers||{},t.obj.map(e.wire,function(e,n){t.fns.is(e)&&(r.__.opt.wire[n]=e)}),t.obj.map(["key","on","path","map","not","init"],function(t){e[t]&&(r.__.opt[t]=e[t]||r.__.opt[t])}),n||t.on("opt").emit(r,e),o},t.chain.chain=function(e){var n=this,o=n.back?t(n):n;return o.back=o.back||n,o.__=o.__||n.__,o._=o._||{},o._.on=o._.on||t.on.create(),o._.at=o._.at||t.on.at(o._.on),o},t.chain.put=function(e,n,o){function r(r){function u(e,n,o){var a;if(e&&(a=e.at)&&e.at.node){if(a.node._||(a.node._={}),a.node._[t._.state]||(a.node._[t._.state]={}),!t.is.node.soul(a.node))if(l.obj===a.obj)t.obj.as(e.graph,a.soul=t.obj.as(a.node._,t._.soul,t.is.node.soul(a.obj)||l.soul),a.node),n(a,a.soul);else{var u=function(o,r){u.opt&&u.opt.on&&u.opt.on.off&&u.opt.on.off(),u.opt.done||(u.opt.done=!0,o&&(e.err=o),a.soul=t.is.node.soul(r)||t.is.node.soul(a.obj)||t.is.node.soul(a.node)||t.text.random(),t.obj.as(e.graph,t.obj.as(a.node._,t._.soul,a.soul),a.node),n(a,a.soul))};u.opt={put:!0},l.not?u():(r.field||r.at?i.back:i).path(a.path||[],u,u.opt)}a.field&&(a.node._[t._.state][a.field]=s)}}function c(s,u){function h(e,o,r){return e?(t.log(e.err||e),n.call(a,e),a._.at("err").emit(e)):n.call(a,e,o)}return l.ify=u,t.on("put").emit(a,r,l,o,n,e),s||u.err?(n.call(a,s||u.err),a._.at("err").emit(s||u.err)):(s=t.union(a,u.graph,{end:!1,soul:function(e){a.__.by(e).end||t.union(a,t.is.node.soul.ify({},e))}}).err)?(n.call(a,s),a._.at("err").emit(s)):(t.fns.is(c.wire=a.__.opt.wire.put)?c.wire(u.graph,h,o):(t.log.count("no-wire-put")||t.log("Warning! You have no persistence layer to save to!"),n.call(a,null)),l.field?i.back.path(l.field,null,{chain:o.chain||a}):l.not?i.__.gun.get(l.soul,null,{chain:o.chain||a}):void a.get(l.soul,null,{chain:o.chain||a,at:i._.at}))}if(!n.hash[r.hash=r.hash||t.on.at.hash(r)]){n.hash[r.hash]=!0;var l={obj:e};if(l.soul=r.field?r.soul:r.at&&r.at.soul||r.soul,l.field=r.field?r.field:r.at&&r.at.field||r.field,l.by=a.__.by(l.soul),l.not=r.not||r.at&&r.at.not,t.obj.del(r,"not"),t.obj.del(r.at||r,"not"),l.field)t.obj.as(l.obj={},l.field,e);else if(!t.obj.is(e))return n.call(a,l.err={err:t.log("No node exists to put "+typeof e+' "'+e+'" in!')}),a._.at("err").emit(l.err);t.ify(l.obj,u,{pure:!0})(c)}}o=o||{},n=n||function(){},n.hash={};var i=this,a=i.chain(),s=t.time.now();if(i===i.back)r({soul:t.is.node.soul(e)||t.text.random(),not:!0});else{i._.at("soul").map(r);var u=function(n){return n.back===n||n._.not?void 0:(n._.at("null").event(function(r){return o.init||n.__.opt.init?t.log("Warning! You have no context to `.put`",e,"!"):void n.init()},-999),u(n.back))};o.init||i.__.opt.init||u(i)}return a.back=i.back,a},t.chain.get=function(){return t.on("operating").event(function(t,e){t.__.by(e.soul).node||(t.__.by(e.soul).node=t.__.graph[e.soul]),e.field||t.__.on(e.soul).emit(e)}),t.on("get").event(function(e,n,o,r,i){if(!o.halt){if(n.change=n.change||e.__.by(n.soul).node,r.raw)return i.call(r.on,n);o.cb.no||i.call(o.by.chain,null,t.obj.copy(o.node||e.__.by(n.soul).node)),e._.at("soul").emit(n).chain(r.chain)}},0),t.on("get").event(function(t,e,n){return n.halt?void(n.halt=!1):void 0},1/0),function(e,n,o){function r(e){var n=e[t._.soul],o=u.__.by(n).node||u.__.graph[n];if(c.force)c.force=!1;else if(o)return!1;return a(e,i,c.opt),!0}function i(e,n,o){return t.on("wire.get").emit(c.by.chain,c,e,n,o),e?(t.log(e.err||e),c.cb.call(c.by.chain,e),c.by.chain._.at("err").emit({soul:c.soul,err:e.err||e}).chain(c.opt.chain)):n?t.obj.empty(n)?void 0:(e=t.union(c.by.chain,n).err)?(c.cb.call(c.by.chain,e),
c.by.chain._.at("err").emit({soul:t.is.node.soul(n)||c.soul,err:e.err||e}).chain(c.opt.chain)):void 0:(c.cb.call(c.by.chain,null),c.by.chain._.at("null").emit({soul:c.soul,not:!0}).chain(c.opt.chain))}function a(e,n,o){return t.on("get.wire").emit(c.by.chain,c,e,n,o),t.fns.is(u.__.opt.wire.get)?u.__.opt.wire.get(e,n,o):(t.log.count("no-wire-get")||t.log("Warning! You have no persistence layer to get from!"),void n(null))}function s(e){(s.ran=!0)&&(c.opt.on=this),r(c.lex)||t.on("get").emit(c.by.chain,e,c,c.opt,c.cb,c.lex)}var u=this,c={opt:o||{},cb:n||function(){},lex:t.text.is(e)||t.num.is(e)?t.is.rel.ify(e):e};return c.force=c.opt.force,n!==c.cb&&(c.cb.no=!0),t.obj.is(c.lex)?(c.soul=c.lex[t._.soul])?(c.by=u.__.by(c.soul),c.by.chain=c.by.chain||u.chain(),c.opt.on=(c.opt.at||u.__.at)(c.soul).event(s),c.opt.ran||s.ran||s.call(c.opt.on,{soul:c.soul}),c.by.chain):(c.cb.call(u=this.chain(),{err:t.log("No soul to get!")}),u):(c.cb.call(u=u.chain(),{err:t.log("Invalid get request!",e)}),u)}}(),t.chain.key=function(){return t.on("put").event(function(e,n,o,r,i){r.key||t.is.graph(o.ify.graph,function(n,r){var i={node:e.__.graph[r]};t.is.node.soul(i.node,"key")&&(e.__.by(r).end||(e.__.by(r).end=1),t.is.node(i.node,function(e,i){e=o.ify.graph[i]=o.ify.graph[i]||t.is.node.soul.ify({},i),t.is.node(n,function(o,r){t.is.node.state.ify([e,n],r,o)}),t.obj.del(o.ify.graph,r)}))})}),t.on("get").event(function(e,n,o,r,i){function a(t,n){e.__.gun.get(t,i,{key:o,chain:r.chain||e,force:r.force})}if(!o.halt){if(r.key&&r.key.soul)return n.soul=r.key.soul,e.__.by(r.key.soul).node=t.union.ify(e,r.key.soul),e.__.by(r.key.soul).node._.key="pseudo",void(n.change=t.is.node.soul.ify(t.obj.copy(n.change||e.__.by(n.soul).node),n.soul,!0));if(1===t.is.node.soul(e.__.graph[n.soul],"key")){var s=n.change||e.__.graph[n.soul];o.halt=!0,t.is.node(s,a)}}},-999),function(e,n,o){function r(r){var a={node:i.__.graph[r.soul]};r.soul!==e&&r.key!==e&&(n.hash[r.hash=r.hash||t.on.at.hash(r)]||(n.hash[r.hash]=!0,a.obj=1===t.is.node.soul(a.node,"key")?t.obj.copy(a.node):t.obj.put({},r.soul,t.is.rel.ify(r.soul)),t.obj.as((a.put=t.is.node.ify(a.obj,e,null,!0))._,"key",1),i.__.gun.put(a.put,function(t,e){n.call(this,t,e)},{chain:o.chain,key:!0,init:!0})))}var i=this;return o=t.text.is(o)?{soul:o}:o||{},n=n||function(){},n.hash={},t.text.is(e)&&e?o.soul?(r({soul:o.soul}),i):(i===i.back?n.call(i,{err:t.log("You have no context to `.key`",e,"!")}):i._.at("soul").map(r),i):(n.call(i,{err:t.log("No key!")}),i)}}(),t.chain.on=function(e,n){function o(o){n.on=n.on||this;var i={by:r.__.by(o.soul)},a=i.by.node;return n.on.stat&&n.on.stat.first&&((o=t.on.at.copy(o)).change=i.by.node),n.raw?e.call(n.on,o):(n.once&&this.off(),n.change&&(a=o.change),void((n.empty||!t.obj.empty(a,t._.meta))&&e.call(i.by.chain||r,t.obj.copy(o.field?a[o.field]:a),o.field||o.at&&o.at.field)))}var r=this;return n=t.obj.is(n)?n:{change:n},e=e||function(){},n.on=r._.at("soul").map(o),r===r.back&&t.log("You have no context to `.on`!"),r},t.chain.path=function(){return t.on("get").event(function(e,n,o,r,i,a){if(!o.halt){r.path&&(n.at=r.path);var s={soul:a[t._.soul],field:a[t._.field]};if(s.change=n.change||e.__.by(n.soul).node,s.field){if(!t.obj.has(s.change,s.field))return;o.node=t.is.node.soul.ify({},n.soul),t.is.node.state.ify([o.node,s.change],s.field,s.change[s.field]),n.change=o.node,n.field=s.field}}},-99),t.on("get").event(function(e,n,o,r,i,a){if(!o.halt){var s={};s.change=n.change||e.__.by(n.soul).node,r.put||t.is.node(s.change,function(o,i){var a=t.on.at.copy(n);a.field=i,a.value=o,t.obj.del(a,"at"),a.change=a.change||s.change,(o=t.is.rel(a.value))&&(a={soul:o,at:a}),e._.at("path:"+i).emit(a).chain(r.chain)}),o.end||(o.end=e._.at("end").emit(n).chain(r.chain))}},99),function(e,n,o){o=o||{},n=n||function(){var t=function(){};return t.no=!0,t}(),n.hash={};var r,i=this,a=i.chain();return t.list.is(e)?i===i.back?(n.call(a,o.put?null:{err:t.log("You have no context to `.path`",e,"!")}),a):(i._.at("path:"+e[0]).event(function(r){if(o.done)return void this.off();var s={soul:r.soul,field:r.field,by:i.__.by(r.soul)},u=e[0],c=t.obj.as(n.hash,r.hash,{off:function(){}});if(r.soul!==c.soul){if(c.off(),s.rel=t.is.rel(r.value)||t.is.rel(r.at&&r.at.value)){if(o.put&&1===e.length)return n.call(s.by.chain||a,null,t.is.node.soul.ify({},s.rel));var l=function(t,o){(t||1===e.length)&&n.call(this,t,o,u)};return s.opt={chain:o.chain||a,put:o.put,path:{soul:r.at&&r.at.soul||r.soul,field:u}},i.__.gun.get(s.rel||r.soul,n.no?null:l,s.opt),void((o.on=n.hash[r.hash]=c=s.opt.on).soul=r.soul)}1===e.length&&n.call(s.by.chain||a,null,r.value,s.field),a._.at("soul").emit(r).chain(o.chain)}}),i._.at("null").only(function(n){n.field&&(n.not&&(i.put({},null,{init:!0}),o.init||i.__.opt.init)||((n=t.on.at.copy(n)).field=e[0],n.not=!0,a._.at("null").emit(n).chain(o.chain)))}),i._.at("end").event(function(r){if(this.off(),!r.at||r.at.field!==e[0]){var s={by:i.__.by(r.soul)};t.obj.has(s.by.node,e[0])||((r=t.on.at.copy(r)).field=e[0],r.not=!0,n.call(s.by.chain||a,null),a._.at("null").emit(r).chain(o.chain))}}),e.length>1&&((r=a.path(e.slice(1),n,o)).back=i),r||a):t.text.is(e)?this.path(e.split("."),n,o):t.num.is(e)?this.path(e+"",n,o):(n.call(a,{err:t.log("Invalid path '"+e+"'!")}),a)}}(),t.chain.map=function(e,n){function o(t,n,o){t||n===a||e.call(this,n,o)}function r(t,n){e.hash[this.soul+n]=e.hash[this.soul+n]||this.gun.path(n,o,{chain:u,via:"map"})}function i(e){var n=s.__.by(e.soul).chain||s;t.is.node(e.change,r,{gun:n,soul:e.soul})}var a,s=this,u=s.chain();return e=e||function(){},e.hash={},n=t.bi.is(n)?{change:n}:n||{},n.change=t.bi.is(n.change)?n.change:!0,s.on(i,{raw:!0,change:!0}),s===s.back&&t.log("You have no context to `.map`!"),u},t.chain.val=function(){return t.on("get.wire").event(function(t,e){if(e.soul){var n;(n=t.__.by(e.soul)).end=n.end||-1}},-999),t.on("wire.get").event(function(e,n,o,r){if(!o&&n.soul&&(!r||t.obj.empty(r,t._.meta))){var i=e.__.by(n.soul);i.end=!i.end||i.end<0?1:i.end+1}},-999),function(e,o){function r(n){var r={by:i.__.by(n.soul),at:n.at||n},a=r.by.node,s=r.at.field,u=t.on.at.hash({soul:r.at.key||r.at.soul,field:s});if(!e.hash[u]){if(n.field&&t.obj.has(a,n.field))return e.hash[u]=!0,e.call(r.by.chain||i,t.obj.copy(a[n.field]),n.field);if((o.empty||!t.obj.empty(a,t._.meta))&&!(r.by.end<0))return e.hash[u]=!0,e.call(r.by.chain||i,t.obj.copy(a),s)}}var i=this,a=t.list.slit.call(arguments);return e=t.fns.is(e)?e:function(t,e){n.console.log.apply(n.console,a.concat([e&&(e+=":"),t]))},e.hash={},o=o||{},i.on(r,{raw:!0}),i===i.back&&t.log("You have no context to `.val`!"),i}}(),t.chain.not=function(e,n){function o(o,a){if(o.field){if(t.obj.has(r.__.by(o.soul).node,o.field))return t.obj.del(o,"not"),i._.at(a).emit(o)}else if(o.soul&&r.__.by(o.soul).node)return t.obj.del(o,"not"),i._.at(a).emit(o);if(o.not){var s=function(e){return++s.c?t.log("Warning! Multiple `not` resumes!"):void e._.at.all(function(t,e){i._.at(e).emit(t)})};s.c=-1,s.chain=r.chain(),s.next=e.call(s.chain,n.raw?o:o.field||o.soul||o.not,s),s.soul=t.text.random(),t.is(s.next)&&s(s.next),s.chain._.at("soul").emit({soul:s.soul,field:o.field,not:!0,via:"not"})}}var r=this,i=r.chain();return e=e||function(){},n=n||{},r._.at.all(o),r===r.back&&t.log("You have no context to `.not`!"),i._.not=!0,i},t.chain.init=function(e,n){var o=this;return o._.at("null").event(function(e){if(e.not){var n={by:o.__.by(e.soul)};if(e.field){if(t.obj.has(n.by.node,e.field))return;return void o._.at("soul").emit({soul:e.soul,field:e.field,not:!0})}if(e.soul){if(n.by.node)return;var r=t.text.random();o.__.gun.put(t.is.node.soul.ify({},r,{init:!0})),o.__.gun.key(e.soul,null,r)}}},{raw:!0}),o}}(e),function(t){function e(e,i,a){a=a||{},i=i||function(e,n){n(e.at,t.is.node.soul(e.at.obj)||t.is.node.soul(e.at.node)||t.text.random())};var s=function(t){u.end=t||function(){},o(u)},u={at:{path:[],obj:e},root:{},graph:{},queue:[],seen:[],opt:a,loop:!0};if(!e)return u.err={err:t.log("Serializer does not have correct parameters.")},s;for(u.opt.start&&t.is.node.soul.ify(u.root,u.opt.start),u.at.node=u.root;u.loop&&!u.err;)r(u,u.at),n(u,i),u.queue.length?u.at=u.queue.shift():u.loop=!1;return s}function n(e,i){var a,s,u=function(n,r){n.soul=n.soul||r||t.is.node.soul(n.obj)||t.is.node.soul(n.node),e.opt.pure||(e.graph[n.soul]=t.is.node.soul.ify(n.node,n.soul),e.at.field&&t.is.node.state.ify([n.node],n.field,a,e.opt.state)),t.list.map(n.back,function(e){e[t._.soul]=n.soul}),o(e)};t.obj.map(e.at.obj,function(o,a){if(e.at.val=o,e.at.field=a,s=i(e,u,n)||!0,a===t._.meta)return void(e.at.node[a]=t.obj.copy(o));if(-1!=String(a).indexOf("."))return e.err={err:t.log("Invalid field name on '"+e.at.path.join(".")+"'!")};if(t.is.val(o))e.at.node[a]=t.obj.copy(o);else{var c,l={obj:o,node:{},back:[],path:[a]},h={};if(l.path=(e.at.path||[]).concat(l.path||[]),!t.obj.is(o))return e.err={err:t.log("Invalid value at '"+l.path.join(".")+"'!")};(c=r(e,l))?(h[t._.soul]=t.is.node.soul(c.node)||null,(c.back=c.back||[]).push(e.at.node[a]=h)):(e.queue.push(l),h[t._.soul]=null,l.back.push(e.at.node[a]=h))}}),s||i(e,u)}function o(e){return e.err||!t.list.map(e.seen,function(t){return t.soul?void 0:!0})&&!e.loop?(e.end(e.err,e),e.end=function(){}):void 0}function r(e,n){return t.list.map(e.seen,function(t){return n.obj===t.obj?t:void 0})||e.seen.push(n)&&!1}e.wire=function(n,o,r){return t.text.is(n)?e.wire.from(n,o,r):e.wire.to(n,o,r)},e.wire.to=function(e,n,o){var r,i;return e&&(r=t.is.node.soul(e))?(n=n||function(){},r=i="#'"+JSON.stringify(r)+"'",t.obj.map(e,function(o,a){if(t._.meta!==a){var s="",u=t.is.node.state(e,a);u&&(s+=".'"+JSON.stringify(a)+"'",s+="='"+JSON.stringify(o)+"'",s+=">'"+JSON.stringify(u)+"'",r+=s,s=i+s,n(null,s))}}),r):null},e.wire.from=function(t,e,n){if(!t)return null;for(var o=[],r=-1,i=0;(i=t.indexOf("'",r+1))>=0;)r===i||"\\"===t.charAt(i-1)||(o.push(t.slice(r+1,i)),r=i);return o},t.ify=e}(e);var n=this||{};n.window&&(window.Gun=e),"undefined"!=typeof t&&t.exports&&(t.exports=e),n.console=n.console||{log:function(t){return t}};var o={log:function(t){return n.console.log.apply(n.console,arguments),t},Log:e.log=function(t){return!e.log.squelch&&n.console.log.apply(n.console,arguments),t}};o.debug=function(t,o){return e.log.debug&&t===e.log.debug&&e.log.debug++&&n.console.log.apply(n.console,arguments),o},e.log.count=function(t){return e.log.count[t]=e.log.count[t]||0,e.log.count[t]++}}(),function(t){if(this.Gun){if(!window.JSON)throw new Error("Include JSON first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");!function(t){function e(){}e.put=function(t,e){return n.setItem(t,Gun.text.ify(e))},e.get=function(t,e){setTimeout(function(){return e(null,Gun.obj.ify(n.getItem(t)||null))},1)},e.del=function(t){return n.removeItem(t)};var n=this.localStorage||{setItem:function(){},removeItem:function(){},getItem:function(){}};t.store=e}(t),Gun.on("opt").event(function(n,o){o=o||{};var r=n.tab=n.tab||{};r.store=r.store||t.store,r.request=r.request||e,r.headers=o.headers||{},r.headers["gun-sid"]=r.headers["gun-sid"]||Gun.text.random(),r.prefix=r.prefix||o.prefix||"gun/",r.get=r.get||function(t,e,o){if(t){var i=t[Gun._.soul];i&&(e=e||function(){},e.GET=!0,(o=o||{}).url=o.url||{},o.headers=Gun.obj.copy(r.headers),o.url.pathname="/"+i,function(t,e){r.store.get(r.prefix+t,function(t,n){if(n){if(t)return e(t);e(t,e.node=n),e(t,Gun.is.node.soul.ify({},Gun.is.node.soul(n))),e(t,{})}})}(i,e),(e.local=o.local)||Gun.obj.map(o.peers||n.__.opt.peers,function(t,n){var i={};r.request(n,null,r.error(e,"Error: Get failed through "+n,function(t){!i.node&&e.node&&r.put(Gun.is.graph.ify(i.node=e.node),function(t,e){},{peers:r.peers(n)}),setTimeout(function(){r.put(t.body,function(){},{local:!0})},1)}),o),e.peers=!0}),r.peers(e))}},r.put=r.put||function(t,e,o){e=e||function(){},o=o||{},Gun.is.graph(t,function(t,e){n.__.graph[e]&&r.store.put(r.prefix+e,n.__.graph[e])}),(e.local=o.local)||Gun.obj.map(o.peers||n.__.opt.peers,function(n,o){r.request(o,t,r.error(e,"Error: Put failed on "+o),{headers:r.headers}),e.peers=!0}),r.peers(e)},r.error=function(t,e,n){return function(o,r){return r.body=r.body||r.chunk||r.end||r.write,o||!r||(o=r.body&&r.body.err)?t({err:Gun.log(o||e)}):(n&&n(r),void t(null,r.body))}},r.peers=function(t,e){return Gun.text.is(t)?((e={})[t]={},e):void(t&&!t.peers&&setTimeout(function(){t.local||Gun.log.count("no-peers")||Gun.log("Warning! You have no peers to connect to!"),t.graph||t.node||t(null)},1))},r.server=r.server||function(t,e){return t&&e&&t.url&&t.method?(t.url=t.url.href?t.url:document.createElement("a"),t.url.href=t.url.href||t.url,t.url.key=(t.url.pathname||"").replace(r.server.regex,"").replace(/^\//i,"")||"",t.method=t.body?"put":"get","get"==t.method?r.server.get(t,e):"put"==t.method||"post"==t.method?r.server.put(t,e):void 0):void 0},r.server.json="application/json",r.server.regex=n.__.opt.route=n.__.opt.route||o.route||/^\/gun/i,r.server.get=function(){},r.server.put=function(t,e){var o={headers:{"Content-Type":r.server.json}};return t.body?void((t.err=Gun.union(n,t.body,function(r,i){if(r)return e({headers:o.headers,body:{err:r||"Union failed."}});var i=i||{};i.graph={},Gun.is.graph(t.body,function(t,e){i.graph[e]=n.__.graph[e]}),n.__.opt.wire.put(i.graph,function(t,n){return t?e({headers:o.headers,body:{err:t||"Failed."}}):void e({headers:o.headers,body:{ok:n||"Persisted."}})},{local:!0})}).err)&&e({headers:o.headers,body:{err:t.err||"Union failed."}})):e({headers:o.headers,body:{err:"No body"}})},Gun.obj.map(n.__.opt.peers,function(){return r.server.able=r.server.able||r.request.createServer(r.server)||!0}),n.__.opt.wire.get=n.__.opt.wire.get||r.get,n.__.opt.wire.put=n.__.opt.wire.put||r.put,n.__.opt.wire.key=n.__.opt.wire.key||r.key});var e=function(){function t(e,n,o,r){r=r||(e.length?{base:e}:e),r.base=r.base||e,r.body=r.body||n,r.base&&t.transport(r,o)}return t.createServer=function(e){t.createServer.s.push(e)},t.createServer.ing=function(e,n){for(var o=t.createServer.s.length;o--;)(t.createServer.s[o]||function(){})(e,n)},t.createServer.s=[],t.back=2,t.backoff=2,t.transport=function(e,n){t.ws(e,n)||t.jsonp(e,n)},t.ws=function(e,n){var o,r=window.WebSocket||window.mozWebSocket||window.webkitWebSocket;if(r){if(o=t.ws.peers[e.base]){if(!o.readyState)return setTimeout(function(){t.ws(e,n)},10),!0;var i={};return e.headers&&(i.headers=e.headers),e.body&&(i.body=e.body),e.url&&(i.url=e.url),i.headers=i.headers||{},t.ws.cbs[i.headers["ws-rid"]="WS"+ +new Date+"."+Math.floor(65535*Math.random()+1)]=function(e,o){(o.body||o.end)&&delete t.ws.cbs[i.headers["ws-rid"]],n(e,o)},o.send(JSON.stringify(i)),!0}if(o!==!1)return o=t.ws.peers[e.base]=new r(e.base.replace("http","ws")),o.onopen=function(o){t.back=2,t.ws(e,n)},o.onclose=window.onbeforeunload=function(r){if(r){if(o&&o.close instanceof Function&&o.close(),1006===r.code)return o=t.ws.peers[e.base]=!1,void t.transport(e,n);o=t.ws.peers[e.base]=null,setTimeout(function(){t.ws(e,function(){})},t.back*=t.backoff)}},o.onmessage=function(e){if(e&&e.data){var n;try{n=JSON.parse(e.data)}catch(o){return}if(n)return n.headers=n.headers||{},n.headers["ws-rid"]?(t.ws.cbs[n.headers["ws-rid"]]||function(){})(null,n):void(n.body&&t.createServer.ing(n,function(){}))}},o.onerror=function(t){Gun.log(t)},!0}},t.ws.peers={},t.ws.cbs={},t.jsonp=function(e,n){t.jsonp.ify(e,function(o){o&&t.jsonp.send(o,function(o){n(null,o),t.jsonp.poll(e,o)},e.jsonp)})},t.jsonp.send=function(t,e,n){var o=document.createElement("script");return o.src=t,window[o.id=n]=function(t){e(t),e.id=o.id,o.parentNode.removeChild(o),window[e.id]=null;try{delete window[e.id]}catch(n){}},o.async=!0,document.getElementsByTagName("head")[0].appendChild(o),o},t.jsonp.poll=function(e,n){e&&e.base&&n&&n.headers&&n.headers.poll&&((t.jsonp.poll.s=t.jsonp.poll.s||{})[e.base]=t.jsonp.poll.s[e.base]||setTimeout(function(){var n={base:e.base,headers:{pull:1}};t.each(e.headers,function(t,e){n.headers[e]=t}),t.jsonp(n,function(n,o){for(delete t.jsonp.poll.s[e.base];o.body&&o.body.length&&o.body.shift;){var r=o.body.shift();r&&r.body&&t.createServer.ing(r,function(){})}})},n.headers.poll))},t.jsonp.ify=function(e,n){var o=encodeURIComponent,r="?";if(e.url&&e.url.pathname&&(r=e.url.pathname+r),r=e.base+r,t.each((e.url||{}).query,function(t,e){r+=o(e)+"="+o(t)+"&"}),e.headers&&(r+=o("`")+"="+o(JSON.stringify(e.headers))+"&"),t.jsonp.max<r.length)return n();if(r+=o("jsonp")+"="+o(e.jsonp="P"+Math.floor(65535*Math.random()+1)),e.body){r+="&";var i=e.body,a=function(t,e,n){return o("%")+"="+o(t+"-"+(e||t)+"/"+(n||t))+"&"+o("$")+"="};"string"!=typeof i&&(i=JSON.stringify(i),r+=o("^")+"="+o("json")+"&"),i=o(i);var s=0,u=i.length,c=t.jsonp.max-(r.length+a(u.toString()).length);if(0>c)return n();for(;i;)n(r+a(s,s+=c,u)+i.slice(0,s)),i=i.slice(s)}else n(r)},t.jsonp.max=2e3,t.each=function(t,e){if(t&&e)for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)},t}()}}({})},function(t,e,n){!function(){function t(t,e,n){return o.runAnimation(t,e,n)}var o=n(7),r=[[0,60],[4.7,33.018],[9.41,6.992],[14.11,-8.455],[18.72,-12.727],[24.32,-9.033],[29.93,-2.855],[35.54,1.234],[41.04,2.351],[52.15,.527],[63.26,-.434],[85.49,0],[100,0]],i={},a={};r.reduce(function(t,e){return i[""+e[0]+"%"]=[0,e[1]],a[""+e[0]+"%"]=[0,-e[1]],t+1},0),o.registerAnimation({name:"bounce-up-1",animation:i,presets:{duration:1e3,easing:"linear"}}),o.registerAnimation({name:"bounce-up-2",animation:i,presets:{duration:1e3,easing:"linear"}}),o.registerAnimation({name:"bounce-down-1",animation:a,presets:{duration:1e3,easing:"linear"}}),o.registerAnimation({name:"bounce-down-2",animation:a,presets:{duration:1e3,easing:"linear"}});var s=[0,40,50,60,80,100],u=[[{rotate:8,opacity:0,translate:[3,-3]}],[{opacity:.3,translate:[8,-20]}],[{opacity:.4,translate:[4,-30]}],[{opacity:.3,translate:[2,-40]}],[{opacity:.1,translate:[5,-50]}],[{rotate:0,opacity:0,translate:[8,-70]}]],c=[[{rotate:-22,opacity:0,translate:[-2,-5]}],[{opacity:.2,translate:[-3,-20]}],[{opacity:.3,translate:[-6,-30]}],[{opacity:.2,translate:[-5,-40]}],[{translate:[-3,-50]}],[{rotate:0,opacity:0,translate:[-4,-70]}]],l=[[{rotate:15,opacity:0,translate:[3,-10]}],[{opacity:.2,translate:[8,-30]}],[{opacity:.35,translate:[11,-40]}],[{opacity:.2,translate:[9,-50]}],[{translate:[7,-60]}],[{rotate:0,opacity:0,translate:[5,-70]}]],h={},p={},f={};return s.reduce(function(t,e){return h[""+e]=u[t][0],p[""+e]=c[t][0],f[""+e]=l[t][0],t+1},0),o.registerAnimation({name:"fly-1",animation:h,presets:{duration:2500,easing:"linear"}}),o.registerAnimation({name:"fly-2",animation:p,presets:{duration:1800,easing:"linear"}}),o.registerAnimation({name:"fly-3",animation:f,presets:{duration:3300,easing:"linear"}}),e.play=t,t}()},function(t,e,n){!function(){function t(t){return t?t.toArray?t.toArray():t:[]}n(34),n(49),n(48),n(33);var e=n(30).play,o=n(32),r=o.ENTER_KEY,i=o.ITEM_HEIGHT;Todos=new TodoModel("todo/data");var a=window.requestAnimationFrame||setTimeout,s=function(t){return t?a(function(){return a(t)}):void 0},u=10,c=0;tag$.extendTag("htmlelement",function(t){t.prototype.bounce=function(t){return this._bounce&&this._bounce!="bounce-"+t+"-2"?this._bounce="bounce-"+t+"-2":this._bounce="bounce-"+t+"-1",e(this._dom,this._bounce),this},t.prototype.setMoveTo=function(t){var e=this;return s(function(){return 0==e._dom.style.opacity?e._dom.style.opacity=1:void 0}),e._dom.style.top==""+t+"px"?e:(~~t<~~e._y&&e.bounce("up"),(!e._y||~~t>~~e._y)&&e.bounce("down"),e._dom.style.top=""+t+"px",e._y=t,e)}}),tag$.defineTag("heart","div",function(t){var n=["","","",""];t.prototype.render=function(){return this.flag("heart").setChildren(""+this._heart,3).synced()},t.prototype.build=function(){var t=this;return t._heart=n[Math.floor(Math.random()*n.length)],t._fly="fly-"+(Math.floor(3*Math.random())+1),t._dom.style.fontSize=Math.floor(6*Math.random())+15+"px",e(t._dom,t._fly,function(){return t.orphanize(),c--}),c++,t.render(),t}}),tag$.defineTag("app",function(e){e.prototype.hash=function(){return this._hash},e.prototype.model=function(){return this._model},e.prototype.build=function(){var t=this;return t._model=Todos,t._model.subscribe(function(){return u>c&&q$$("#heartbox").append(tag$.$heart().end()),t.render()}),t._model.load(),window.addEventListener("hashchange",function(){return t._hash=window.location.hash,t.render()}),t._hash=window.location.hash,t.render(),t},e.prototype.onkeydown=function(t){var e,n;return t.which()==r&&(e=t.target().value().trim())?(this.model().addTodo(e),t.target().setValue(n=""),n):void 0},e.prototype.toggleAll=function(t){return this.model().toggleAll(t.target().checked())},e.prototype.clearCompleted=function(){return q$$(".toggle-all",this).setChecked(!1),this.model().clearCompleted()},e.prototype.list=function(e){for(var n,o=0,r=t(e),a=r.length,s=[];a>o;o++)n=r[o],s.push((this["_"+n.id]=this["_"+n.id]||tag$.$todo()).setMoveTo(""+o*i).setObject(n).end());return s},e.prototype.render=function(){for(var e,n,o,r,a,s,u,c,l,h,p,f=Todos.sorted(),d=f.length,m=[],g=[],b=0,y=t(f),v=y.length;v>b;b++)p=y[b],p.completed?m.push(p):g.push(p);var _={"#/completed":m,"#/active":g}[this._hash]||f;return this.setChildren([(e=this.$a=this.$a||tag$.$header().flag("header")).setContent([(e.$$a=e.$$a||tag$.$h1()).setText("todos").end(),(e.$$b=e.$$b||tag$.$p().setId("heartbox")).end(),(e.$$c=e.$$c||tag$.$input().flag("new-todo").setType("text").setPlaceholder("What to do?")).end()],2).end(),d>0?(n=this.$b=this.$b||tag$.$section().flag("main")).setContent([(n.$$a=n.$$a||tag$.$input().flag("toggle-all").setType("checkbox").setHandler("change","toggleAll",this)).setChecked(m.length==d).end(),(o=n.$$b=n.$$b||tag$.$ul().flag("todo-list")).setContent(this.list(_),3).end()],2).end():void 0,d>0?(r=this.$c=this.$c||tag$.$footer().flag("footer")).setMoveTo(""+_.length*i).setContent([(a=r.$$a=r.$$a||tag$.$span().flag("todo-count")).setContent([(s=a.$$a=a.$$a||tag$.$strong()).setContent(""+g.length+" ",3).end(),1==g.length?"item left":"items left"],1).end(),(u=r.$$b=r.$$b||tag$.$ul().flag("filters")).setContent([(c=u.$$a=u.$$a||tag$.$li()).setContent((c.$$a=c.$$a||tag$.$a().setHref("#/")).flag("selected",_==f).setText("All").end(),2).end(),(l=u.$$b=u.$$b||tag$.$li()).setContent((l.$$a=l.$$a||tag$.$a().setHref("#/active")).flag("selected",_==g).setText("Active").end(),2).end(),(h=u.$$c=u.$$c||tag$.$li()).setContent((h.$$a=h.$$a||tag$.$a().setHref("#/completed")).flag("selected",_==m).setText("Completed").end(),2).end()],2).end(),m.length>0?(r.$$c=r.$$c||tag$.$button().flag("clear-completed").setHandler("tap","clearCompleted",this)).setText("Clear completed").end():void 0],1).end():void 0],1).synced()}});var l=tag$.$app().setId("app").end();return q$$("body").append(l)}()},function(t,e){!function(){var e,n,o;return t.exports.ESCAPE_KEY=e=27,t.exports.ENTER_KEY=n=13,t.exports.ITEM_HEIGHT=o=60,tag$.defineTag("todo","li",function(t){t.prototype.model=function(){return this.up(q$("._app",this)).model()},t.prototype.commit=function(){return this._hash!=this.hash(this._object)&&(this._hash=this.hash(this._object),this.render()),this},t.prototype.hash=function(t){return""+t.id+t.title+t.completed+this._editing},t.prototype.render=function(){var t,e,n=this._object;return this.flag("completed",n.completed).setChildren([(t=this.$a=this.$a||tag$.$div().flag("view")).setContent([(e=t.$$a=t.$$a||tag$.$label().setHandler("dblclick","edit",this)).setContent(""+n.title,3).end(),(this._toggle=this._toggle||tag$.$input().setRef("toggle",this).setType("checkbox").setHandler("change","toggle",this)).setChecked(n.completed).end(),(t.$$c=t.$$c||tag$.$button().flag("destroy").setHandler("tap","drop",this)).end()],2).end(),(this._input=this._input||tag$.$input().setRef("input",this).flag("edit").setType("text")).end()],2).synced()},t.prototype.edit=function(){var t=this;return this._editing=!0,this.flag("editing"),this._input.setValue(this._object.title),setTimeout(function(){return t._input.focus()},10),t.render()},t.prototype.drop=function(){return this.model().destroy(this.object())},t.prototype.toggle=function(t){return this.model().toggle(this._object)},t.prototype.submit=function(){this._editing=!1,this.unflag("editing");var t=this._input.value().trim();return this._object.title!=t?(this._object.title=t,t?this.model().rename(this.object(),t):this.model().destroy(this.object()),this.render()):void 0},t.prototype.onfocusout=function(t){return this._editing?this.submit():void 0},t.prototype.cancel=function(){return this._editing=!1,this.unflag("editing"),this._input.blur(),this.render()},t.prototype.onkeydown=function(t){return t.halt(),t.which()==n&&this.submit(),t.which()==e?this.cancel():void 0}})}()},function(t,e,n){(function(t){!function(){function e(t){return t?t.toArray?t.toArray():t:[]}function o(t){this._listeners=[],this._key=t}n(29);var r=100;return t.TodoModel=o,o.prototype.__items={"default":[],name:"items"},o.prototype.items=function(t){return this._items},o.prototype.setItems=function(t){return this._items=t,this},o.prototype._items=[],o.prototype.subscribe=function(t){return this._listeners.push(t),this},o.prototype.sorted=function(){return this._items.sort(function(t,e){var t=t.id.slice(1,20),e=e.id.slice(1,20);return e>t?1:t>e?-1:0})},o.prototype.notify=function(){for(var t=0,n=e(this._listeners),o=n.length,r=[];o>t;t++)r.push(n[t]());return r},o.prototype.inform=function(){var t=this;return t._timeout&&clearTimeout(t._timeout),t._timeout=setTimeout(function(){return t.notify()},r),t},o.prototype.put=function(t,e,n){if(t){var o=e?{title:e.title||"<untitled>",completed:e.completed||!1}:null;return this._todos.path(t).put(o,n),this}},o.prototype.uid=function(){return"I"+Gun.time.now()+"R"+Gun.text.random(5)},o.prototype.addTodo=function(t){return this.put(this.uid(),{title:t,completed:!1})},o.prototype.toggleAll=function(t){for(var n=0,o=e(this._items),r=o.length,i=[];r>n;n++)i.push(this.setCompleted(o[n],t));return i},o.prototype.setCompleted=function(t,e){return void 0===e&&(e=!0),this.put(t.id,{title:t.title,completed:e})},o.prototype.toggle=function(t){return this.put(t.id,{title:t.title,completed:!t.completed})},o.prototype.destroy=function(t){return this.put(t.id,null)},o.prototype.save=function(t){return this.put(t.id,t)},o.prototype.rename=function(t,e){return this.put(t.id,{title:e,completed:t.completed})},o.prototype.clearCompleted=function(){var t=this,e=[];return t._items.map(function(t){return t.completed?e.push(t):void 0}),e.map(function(e){return t.destroy(e)}),t},o.prototype.load=function(){var t=this;return t._gun=Gun(window.location.origin+"/gun"),t._todos=t._gun.get(t._key),t._todos.not(function(){return t.addTodo("Digg it...")}),t._todos.map(function(n,o){if(o){for(var r,i=0,a=e(t._items),s=a.length;s>i;i++)if(r=a[i],r.id==o)var u=r;if(u&&null==n)return t._items.splice(t._items.indexOf(u),1),t.inform();if(u){if(u.title!=n.title||u.completed!=n.completed)return u.title=n.title||"<untitled>",u.completed=n.completed||!1,t.inform()}else if(n)return t._items.push({id:o,title:n.title,completed:n.completed||!1}),t.inform()}}),t},o}()}).call(e,function(){return this}())},function(t,e,n){t.exports=e=n(44)},function(t,e){!function(){function t(t,e,n){for(var o,r,i;(o=n)&&(n=n.next);)(r=n.listener)&&(i=n.path&&r[n.path]?e?r[n.path].apply(r,e):r[n.path]():e?r.apply(n,e):r.call(n)),n.times&&--n.times<=0&&(o.next=n.next,n.listener=null)}return Imba.listen=function(t,e,n,o){var r,i,a,s;return i=t.__listeners__||(t.__listeners__={}),a=i[r=e]||(i[r]={}),s=a.tail||(a.tail=a.next={}),s.listener=n,s.path=o,a.tail=s.next={},s},Imba.once=function(t,e,n){var o=Imba.listen(t,e,n);return o.times=1,o},Imba.unlisten=function(t,e,n,o){var r,i,a=t.__listeners__;if(a&&(r=a[e]))for(;(i=r)&&(r=r.next);)if(r==n||r.listener==n){i.next=r.next,r.listener=null;break}},Imba.emit=function(e,n,o){var r;(r=e.__listeners__)&&(r[n]&&t(n,o,r[n]),r.all&&t(n,[n,o],r.all))},Imba.observeProperty=function(t,e,n,o,r){return r&&"object"==typeof r&&Imba.unlisten(r,"all",t,n),o&&"object"==typeof o&&Imba.listen(o,"all",t,n),this}}()},function(t,e){!function(){function t(t){return t?t.toArray?t.toArray():t:[]}if(Imba.CLIENT){var e=window.getComputedStyle(document.documentElement,"");Imba.CSSKeyMap={};for(var n,o=0,r=t(e),i=r.length;i>o;o++){n=r[o];var a=n.replace(/^-(webkit|ms|moz|o|blink)-/,""),s=a.replace(/-(\w)/g,function(t,e){return e.toUpperCase()});n!=a&&e.hasOwnProperty(a)||(Imba.CSSKeyMap[a]=Imba.CSSKeyMap[s]=n)}if(tag$.extendTag("element",function(t){t.prototype.css=function(t,e){if(t instanceof Object){for(var n=0,o=Object.keys(t),r=o.length;r>n;n++)this.css(o[n],t[o[n]]);return this}if(t=Imba.CSSKeyMap[t]||t,null==e)this.dom().style.removeProperty(t);else{if(void 0==e)return this.dom().style[t];("number"==typeof e||e instanceof Number)&&t.match(/width|height|left|right|top|bottom/)&&(e+="px"),this.dom().style[t]=e}return this}}),!document.documentElement.classList)return tag$.extendTag("element",function(t){t.prototype.hasFlag=function(t){return new RegExp("(^|\\s)"+t+"(\\s|$)").test(this._dom.className)},t.prototype.addFlag=function(t){return this.hasFlag(t)?this:(this._dom.className+=(this._dom.className?" ":"")+t,this)},t.prototype.unflag=function(t){if(!this.hasFlag(t))return this;var e=new RegExp("(^|\\s)*"+t+"(\\s|$)*","g");return this._dom.className=this._dom.className.replace(e,""),this},t.prototype.toggleFlag=function(t){return this.hasFlag(t)?this.unflag(t):this.flag(t)},t.prototype.flag=function(t,e){return 2==arguments.length&&0==!!e?this.unflag(t):this.addFlag(t)}}),!0}}()},function(t,e){!function(){function t(t){return t?t.toArray?t.toArray():t:[]}var e=document,n=window,o=window&&void 0!==window.ontouchstart;Imba.Pointer=function(){return this.setButton(-1),this.setEvent({x:0,y:0,type:"uninitialized"}),this},Imba.Pointer.prototype.phase=function(t){return this._phase},Imba.Pointer.prototype.setPhase=function(t){return this._phase=t,this},Imba.Pointer.prototype.prevEvent=function(t){return this._prevEvent},Imba.Pointer.prototype.setPrevEvent=function(t){return this._prevEvent=t,this},Imba.Pointer.prototype.button=function(t){return this._button},Imba.Pointer.prototype.setButton=function(t){return this._button=t,this},Imba.Pointer.prototype.event=function(t){return this._event},Imba.Pointer.prototype.setEvent=function(t){return this._event=t,this},Imba.Pointer.prototype.dirty=function(t){return this._dirty},Imba.Pointer.prototype.setDirty=function(t){return this._dirty=t,this},Imba.Pointer.prototype.events=function(t){return this._events},Imba.Pointer.prototype.setEvents=function(t){return this._events=t,this},Imba.Pointer.prototype.touch=function(t){return this._touch},Imba.Pointer.prototype.setTouch=function(t){return this._touch=t,this},Imba.Pointer.prototype.update=function(t){return this.setEvent(t),this.setDirty(!0),this},Imba.Pointer.prototype.process=function(){var t=this.event();if(this.dirty())if(this.setPrevEvent(t),this.setDirty(!1),"mousedown"==t.type){if(this.setButton(t.button),2==this.button()||this.touch()&&0!=this.button())return;this.touch()&&this.touch().cancel(),this.setTouch(new Imba.Touch(t,this)),this.touch().mousedown(t,t)}else"mousemove"==t.type?this.touch()&&this.touch().mousemove(t,t):"mouseup"==t.type&&(this.setButton(-1),this.touch()&&this.touch().button()==t.button&&(this.touch().mouseup(t,t),this.setTouch(null)));else this.touch()&&this.touch().idle();return this},Imba.Pointer.prototype.cleanup=function(){return Imba.POINTERS},Imba.Pointer.prototype.x=function(){return this.event().x},Imba.Pointer.prototype.y=function(){return this.event().y},Imba.Pointer.update=function(){for(var e=0,o=t(Imba.POINTERS),r=o.length;r>e;e++)o[e].process();return n.requestAnimationFrame(Imba.Pointer.update),this};var r=0,i=50;Imba.Touch=function(t,e){return this.setEvent(t),this.setData({}),this.setActive(!0),this._button=t&&t.button||0,this._suppress=!1,this._captured=!1,this.setBubble(!1),e=e,this.setUpdates(0),this};var a=[],s=0,u={};return Imba.Touch.count=function(){return s},Imba.Touch.lookup=function(t){
return t&&(t.__touch__||u[t.identifier])},Imba.Touch.release=function(t,e){var n,o;n=u[t.identifier],delete u[t.identifier],o=t.__touch__,delete t.__touch__,o},Imba.Touch.ontouchstart=function(e){for(var n,o=0,r=t(e.changedTouches),i=r.length;i>o;o++)if(n=r[o],!this.lookup(n)){var c=u[n.identifier]=new this(e);n.__touch__=c,a.push(c),s++,c.touchstart(e,n)}return this},Imba.Touch.ontouchmove=function(e){for(var n,o,r=0,i=t(e.changedTouches),a=i.length;a>r;r++)o=i[r],(n=this.lookup(o))&&n.touchmove(e,o);return this},Imba.Touch.ontouchend=function(e){for(var n,o,r=0,i=t(e.changedTouches),a=i.length;a>r;r++)o=i[r],(n=this.lookup(o))&&(n.touchend(e,o),this.release(o,n),s--);return this},Imba.Touch.ontouchcancel=function(e){for(var n,o,r=0,i=t(e.changedTouches),a=i.length;a>r;r++)o=i[r],(n=this.lookup(o))&&(n.touchcancel(e,o),this.release(o,n),s--);return this},Imba.Touch.onmousedown=function(t){return this},Imba.Touch.onmousemove=function(t){return this},Imba.Touch.onmouseup=function(t){return this},Imba.Touch.prototype.phase=function(t){return this._phase},Imba.Touch.prototype.setPhase=function(t){return this._phase=t,this},Imba.Touch.prototype.active=function(t){return this._active},Imba.Touch.prototype.setActive=function(t){return this._active=t,this},Imba.Touch.prototype.event=function(t){return this._event},Imba.Touch.prototype.setEvent=function(t){return this._event=t,this},Imba.Touch.prototype.pointer=function(t){return this._pointer},Imba.Touch.prototype.setPointer=function(t){return this._pointer=t,this},Imba.Touch.prototype.target=function(t){return this._target},Imba.Touch.prototype.setTarget=function(t){return this._target=t,this},Imba.Touch.prototype.handler=function(t){return this._handler},Imba.Touch.prototype.setHandler=function(t){return this._handler=t,this},Imba.Touch.prototype.updates=function(t){return this._updates},Imba.Touch.prototype.setUpdates=function(t){return this._updates=t,this},Imba.Touch.prototype.suppress=function(t){return this._suppress},Imba.Touch.prototype.setSuppress=function(t){return this._suppress=t,this},Imba.Touch.prototype.data=function(t){return this._data},Imba.Touch.prototype.setData=function(t){return this._data=t,this},Imba.Touch.prototype.__bubble={chainable:!0,name:"bubble"},Imba.Touch.prototype.bubble=function(t){return void 0!==t?(this.setBubble(t),this):this._bubble},Imba.Touch.prototype.setBubble=function(t){return this._bubble=t,this},Imba.Touch.prototype.gestures=function(t){return this._gestures},Imba.Touch.prototype.setGestures=function(t){return this._gestures=t,this},Imba.Touch.prototype.capture=function(){return this._captured=!0,this._event&&this._event.preventDefault(),this},Imba.Touch.prototype.isCaptured=function(){return!!this._captured},Imba.Touch.prototype.extend=function(t){return this._gestures||(this._gestures=[]),this._gestures.push(t),this},Imba.Touch.prototype.redirect=function(t){return this._redirect=t,this},Imba.Touch.prototype.suppress=function(){return this._active=!1,this},Imba.Touch.prototype.setSuppress=function(t){return console.warn("Imba.Touch#suppress= is deprecated"),this._supress=t,this},Imba.Touch.prototype.touchstart=function(t,e){return this._event=t,this._touch=e,this._button=0,this._x=e.clientX,this._y=e.clientY,this.began(),t&&this.isCaptured()&&t.preventDefault(),this},Imba.Touch.prototype.touchmove=function(t,e){return this._event=t,this._x=e.clientX,this._y=e.clientY,this.update(),t&&this.isCaptured()&&t.preventDefault(),this},Imba.Touch.prototype.touchend=function(t,e){if(this._event=t,this._x=e.clientX,this._y=e.clientY,this.ended(),r=t.timeStamp,this._maxdr<20){var n=new Imba.Event(t);n.setType("tap"),n.process(),n._responder&&t.preventDefault()}return t&&this.isCaptured()&&t.preventDefault(),this},Imba.Touch.prototype.touchcancel=function(t,e){return this.cancel()},Imba.Touch.prototype.mousedown=function(t,n){var o=this;return o._event=t,o._button=t.button,o._x=n.clientX,o._y=n.clientY,o.began(),o._mousemove=function(t){return o.mousemove(t,t)},e.addEventListener("mousemove",o._mousemove,!0),o},Imba.Touch.prototype.mousemove=function(t,e){return this._x=e.clientX,this._y=e.clientY,this._event=t,this.isCaptured()&&t.preventDefault(),this.update(),this.move(),this},Imba.Touch.prototype.mouseup=function(t,n){return this._x=n.clientX,this._y=n.clientY,this.ended(),e.removeEventListener("mousemove",this._mousemove,!0),this._mousemove=null,this},Imba.Touch.prototype.idle=function(){return this.update()},Imba.Touch.prototype.began=function(){this._maxdr=this._dr=0,this._x0=this._x,this._y0=this._y;var t=this.event().target,e=null;for(this._sourceTarget=t&&tag$wrap(t);t&&(e=tag$wrap(t),!e||!e.ontouchstart||(this._bubble=!1,this.setTarget(e),this.target().ontouchstart(this),this._bubble));)t=t.parentNode;return this._updates++,this},Imba.Touch.prototype.update=function(){var e;if(!this._active)return this;var n=Math.sqrt(this.dx()*this.dx()+this.dy()*this.dy());if(n>this._dr&&(this._maxdr=n),this._dr=n,this._redirect&&(this._target&&this._target.ontouchcancel&&this._target.ontouchcancel(this),this.setTarget(this._redirect),this._redirect=null,this.target().ontouchstart&&this.target().ontouchstart(this)),this._updates++,this._gestures)for(var o=0,r=t(this._gestures),i=r.length;i>o;o++)r[o].ontouchupdate(this);return(e=this.target())&&e.ontouchupdate&&e.ontouchupdate(this),this},Imba.Touch.prototype.move=function(){var e;if(!this._active)return this;if(this._gestures)for(var n,o=0,r=t(this._gestures),i=r.length;i>o;o++)n=r[o],n.ontouchmove&&n.ontouchmove(this,this._event);return(e=this.target())&&e.ontouchmove&&e.ontouchmove(this,this._event),this},Imba.Touch.prototype.ended=function(){var e;if(!this._active)return this;if(this._updates++,this._gestures)for(var n=0,o=t(this._gestures),r=o.length;r>n;n++)o[n].ontouchend(this);return(e=this.target())&&e.ontouchend&&e.ontouchend(this),this},Imba.Touch.prototype.cancel=function(){return this._cancelled||(this._cancelled=!0,this.cancelled(),this._mousemove&&e.removeEventListener("mousemove",this._mousemove,!0)),this},Imba.Touch.prototype.cancelled=function(){var e;if(!this._active)return this;if(this._cancelled=!0,this._updates++,this._gestures)for(var n,o=0,r=t(this._gestures),i=r.length;i>o;o++)n=r[o],n.ontouchcancel&&n.ontouchcancel(this);return(e=this.target())&&e.ontouchcancel&&e.ontouchcancel(this),this},Imba.Touch.prototype.dr=function(){return this._dr},Imba.Touch.prototype.dx=function(){return this._x-this._x0},Imba.Touch.prototype.dy=function(){return this._y-this._y0},Imba.Touch.prototype.x0=function(){return this._x0},Imba.Touch.prototype.y0=function(){return this._y0},Imba.Touch.prototype.x=function(){return this._x},Imba.Touch.prototype.y=function(){return this._y},Imba.Touch.prototype.tx=function(){return this._targetBox||(this._targetBox=this._target.dom().getBoundingClientRect()),this._x-this._targetBox.left},Imba.Touch.prototype.ty=function(){return this._targetBox||(this._targetBox=this._target.dom().getBoundingClientRect()),this._y-this._targetBox.top},Imba.Touch.prototype.button=function(){return this._button},Imba.Touch.prototype.sourceTarget=function(){return this._sourceTarget},Imba.TouchGesture=function(){},Imba.TouchGesture.prototype.__active={"default":!1,name:"active"},Imba.TouchGesture.prototype.active=function(t){return this._active},Imba.TouchGesture.prototype.setActive=function(t){return this._active=t,this},Imba.TouchGesture.prototype._active=!1,Imba.TouchGesture.prototype.ontouchstart=function(t){return this},Imba.TouchGesture.prototype.ontouchupdate=function(t){return this},Imba.TouchGesture.prototype.ontouchend=function(t){return this},Imba.POINTER=new Imba.Pointer,Imba.POINTERS=[Imba.POINTER],Imba.KEYMAP={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"break",20:"caps",27:"esc",32:"space",35:"end",36:"home",37:"larr",38:"uarr",39:"rarr",40:"darr",45:"insert",46:"delete",107:"plus",106:"mult",91:"meta"},Imba.CHARMAP={"%":"modulo","*":"multiply","+":"add","-":"sub","/":"divide",".":"dot"},Imba.Event=function(t){this.setEvent(t),this.setBubble(!0)},Imba.Event.prototype.event=function(t){return this._event},Imba.Event.prototype.setEvent=function(t){return this._event=t,this},Imba.Event.prototype.prefix=function(t){return this._prefix},Imba.Event.prototype.setPrefix=function(t){return this._prefix=t,this},Imba.Event.prototype.data=function(t){return this._data},Imba.Event.prototype.setData=function(t){return this._data=t,this},Imba.Event.prototype.source=function(t){return this._source},Imba.Event.prototype.setSource=function(t){return this._source=t,this},Imba.Event.prototype.__bubble={type:Boolean,chainable:!0,name:"bubble"},Imba.Event.prototype.bubble=function(t){return void 0!==t?(this.setBubble(t),this):this._bubble},Imba.Event.prototype.setBubble=function(t){return this._bubble=t,this},Imba.Event.wrap=function(t){return new this(t)},Imba.Event.prototype.setType=function(t){return this._type=t,this},Imba.Event.prototype.type=function(){return this._type||this.event().type},Imba.Event.prototype.name=function(){return this._name||(this._name=this.type().toLowerCase().replace(/\:/g,""))},Imba.Event.prototype.bubble=function(t){return void 0!=t?(this.setBubble(t),this):this._bubble},Imba.Event.prototype.halt=function(){return this.setBubble(!1),this},Imba.Event.prototype.cancel=function(){return this.event().preventDefault&&this.event().preventDefault(),this._cancel=!0,this},Imba.Event.prototype.silence=function(){return this._silenced=!0,this},Imba.Event.prototype.isSilenced=function(){return!!this._silenced},Imba.Event.prototype.isPrevented=function(){return this.event()&&this.event().defaultPrevented||this._cancel},Imba.Event.prototype.target=function(){return tag$wrap(this.event()._target||this.event().target)},Imba.Event.prototype.responder=function(){return this._responder},Imba.Event.prototype.redirect=function(t){return this._redirect=t,this},Imba.Event.prototype.keychar=function(){if(this.event()instanceof KeyboardEvent){var t=this.event().keyIdentifier,e=Imba.KEYMAP[this.event().keyCode];return e||"U+"!=t.substr(0,2)||(e=String.fromCharCode(parseInt(t.substr(2),16))),e}return this.event()instanceof(window.TextEvent||window.InputEvent)?this.event().data:null},Imba.Event.prototype.keycombo=function(){var t;if(t=this.keychar()){t=Imba.CHARMAP[t]||t;var e=[],n=this.event();return n.ctrlKey&&e.push("ctrl"),n.shiftKey&&e.push("shift"),n.altKey&&e.push("alt"),n.metaKey&&e.push("cmd"),e.push(t),e.join("_").toLowerCase()}},Imba.Event.prototype.process=function(){for(var t,e,n="on"+(this._prefix||"")+this.name(),o=null,r=this.event()._target||this.event().target,i=r._responder||r;i;){if(this._redirect=null,t=tag$wrap(i)){if("string"==typeof t[e=n]||t[e]instanceof String){n=t[n];continue}if(t[n]instanceof Array){o=t[n].concat(t),n=o.shift();continue}t[n]instanceof Function&&(this._responder||(this._responder=t),o?t[n].apply(t,o):t[n](this,this.data()))}if(!this.bubble()||!(i=this._redirect||(t?t.parent():i.parentNode)))break}return this.processed(),this},Imba.Event.prototype.processed=function(){return this._silenced||Imba.emit(Imba,"event",[this]),this},Imba.Event.prototype.x=function(){return this.event().x},Imba.Event.prototype.y=function(){return this.event().y},Imba.Event.prototype.which=function(){return this.event().which},Imba.EventManager=function(e,n){var o=this;n&&n.constructor===Object||(n={});var r=void 0!==n.events?n.events:[];o.setRoot(e),o.setCount(0),o.setListeners([]),o.setDelegators({}),o.setDelegator(function(t){return o.delegate(t),!0});for(var i=0,a=t(r),s=a.length;s>i;i++)o.register(a[i]);return o},Imba.EventManager.prototype.root=function(t){return this._root},Imba.EventManager.prototype.setRoot=function(t){return this._root=t,this},Imba.EventManager.prototype.count=function(t){return this._count},Imba.EventManager.prototype.setCount=function(t){return this._count=t,this},Imba.EventManager.prototype.__enabled={"default":!1,watch:"enabledDidSet",name:"enabled"},Imba.EventManager.prototype.enabled=function(t){return this._enabled},Imba.EventManager.prototype.setEnabled=function(t){var e=this.enabled();return t!=e&&(this._enabled=t),t!=e&&this.enabledDidSet&&this.enabledDidSet(t,e,this.__enabled),this},Imba.EventManager.prototype._enabled=!1,Imba.EventManager.prototype.listeners=function(t){return this._listeners},Imba.EventManager.prototype.setListeners=function(t){return this._listeners=t,this},Imba.EventManager.prototype.delegators=function(t){return this._delegators},Imba.EventManager.prototype.setDelegators=function(t){return this._delegators=t,this},Imba.EventManager.prototype.delegator=function(t){return this._delegator},Imba.EventManager.prototype.setDelegator=function(t){return this._delegator=t,this},Imba.EventManager.prototype.enabledDidSet=function(t){return t?this.onenable():this.ondisable(),this},Imba.EventManager.prototype.register=function(e,n){if(void 0===n&&(n=!0),e instanceof Array){for(var o=0,r=t(e),i=r.length;i>o;o++)this.register(r[o],n);return this}if(this.delegators()[e])return this;var a=this.delegators()[e]=n instanceof Function?n:this.delegator();return this.enabled()?this.root().addEventListener(e,a,!0):void 0},Imba.EventManager.prototype.listen=function(t,e,n){return void 0===n&&(n=!0),this.listeners().push([t,e,n]),this.enabled()&&this.root().addEventListener(t,e,n),this},Imba.EventManager.prototype.delegate=function(t){this.setCount(this.count()+1);var e=Imba.Event.wrap(t);return e.process(),this},Imba.EventManager.prototype.create=function(t,e,n){n&&n.constructor===Object||(n={});var o=void 0!==n.data?n.data:null,r=void 0!==n.source?n.source:null,i=Imba.Event.wrap({type:t,target:e});return o&&(i.setData(o),o),r&&(i.setSource(r),r),i},Imba.EventManager.prototype.trigger=function(){return this.create.apply(this,arguments).process()},Imba.EventManager.prototype.onenable=function(){for(var e=this.delegators(),n=0,o=Object.keys(e),r=o.length;r>n;n++)this.root().addEventListener(o[n],e[o[n]],!0);for(var i,n=0,a=t(this.listeners()),s=a.length;s>n;n++)i=a[n],this.root().addEventListener(i[0],i[1],i[2]);return this},Imba.EventManager.prototype.ondisable=function(){for(var e=this.delegators(),n=0,o=Object.keys(e),r=o.length;r>n;n++)this.root().removeEventListener(o[n],e[o[n]],!0);for(var i,n=0,a=t(this.listeners()),s=a.length;s>n;n++)i=a[n],this.root().removeEventListener(i[0],i[1],i[2]);return this},ED=Imba.Events=new Imba.EventManager(document,{events:["keydown","keyup","keypress","textInput","input","change","submit","focusin","focusout","blur","contextmenu","dblclick","mousewheel","wheel","scroll"]}),o&&(Imba.Events.listen("touchstart",function(t){var e,n;return(e=Imba.Events).setCount(n=e.count()+1),Imba.Touch.ontouchstart(t)}),Imba.Events.listen("touchmove",function(t){var e,n;return(e=Imba.Events).setCount(n=e.count()+1),Imba.Touch.ontouchmove(t)}),Imba.Events.listen("touchend",function(t){var e,n;return(e=Imba.Events).setCount(n=e.count()+1),Imba.Touch.ontouchend(t)}),Imba.Events.listen("touchcancel",function(t){var e,n;return(e=Imba.Events).setCount(n=e.count()+1),Imba.Touch.ontouchcancel(t)})),Imba.Events.register("click",function(t){if(t.timeStamp-r>i){var e=new Imba.Event(t);if(e.setType("tap"),e.process(),e._responder)return t.preventDefault()}return Imba.Events.delegate(t)}),Imba.Events.listen("mousedown",function(t){return t.timeStamp-r>i&&Imba.POINTER?Imba.POINTER.update(t).process():void 0}),Imba.Events.listen("mouseup",function(t){return t.timeStamp-r>i&&Imba.POINTER?Imba.POINTER.update(t).process():void 0}),Imba.Events.register(["mousedown","mouseup"]),Imba.Events.setEnabled(!0),!0}()},function(t,e){!function(){return tag$.defineTag("fragment","htmlelement",function(t){t.createNode=function(){return Imba.document().createDocumentFragment()}}),tag$.defineTag("a",function(t){t.prototype.href=function(t){return this.getAttribute("href")},t.prototype.setHref=function(t){return this.setAttribute("href",t),this}}),tag$.defineTag("abbr"),tag$.defineTag("address"),tag$.defineTag("area"),tag$.defineTag("article"),tag$.defineTag("aside"),tag$.defineTag("audio"),tag$.defineTag("b"),tag$.defineTag("base"),tag$.defineTag("bdi"),tag$.defineTag("bdo"),tag$.defineTag("big"),tag$.defineTag("blockquote"),tag$.defineTag("body"),tag$.defineTag("br"),tag$.defineTag("button",function(t){t.prototype.autofocus=function(t){return this.getAttribute("autofocus")},t.prototype.setAutofocus=function(t){return this.setAttribute("autofocus",t),this},t.prototype.type=function(t){return this.getAttribute("type")},t.prototype.setType=function(t){return this.setAttribute("type",t),this},t.prototype.disabled=function(t){return this.getAttribute("disabled")},t.prototype.setDisabled=function(t){return this.setAttribute("disabled",t),this}}),tag$.defineTag("canvas",function(t){t.prototype.setWidth=function(t){return this.width()!=t&&(this.dom().width=t),this},t.prototype.setHeight=function(t){return this.height()!=t&&(this.dom().height=t),this},t.prototype.width=function(){return this.dom().width},t.prototype.height=function(){return this.dom().height},t.prototype.context=function(t){return void 0===t&&(t="2d"),this.dom().getContext(t)}}),tag$.defineTag("caption"),tag$.defineTag("cite"),tag$.defineTag("code"),tag$.defineTag("col"),tag$.defineTag("colgroup"),tag$.defineTag("data"),tag$.defineTag("datalist"),tag$.defineTag("dd"),tag$.defineTag("del"),tag$.defineTag("details"),tag$.defineTag("dfn"),tag$.defineTag("div"),tag$.defineTag("dl"),tag$.defineTag("dt"),tag$.defineTag("em"),tag$.defineTag("embed"),tag$.defineTag("fieldset"),tag$.defineTag("figcaption"),tag$.defineTag("figure"),tag$.defineTag("footer"),tag$.defineTag("form",function(t){t.prototype.method=function(t){return this.getAttribute("method")},t.prototype.setMethod=function(t){return this.setAttribute("method",t),this},t.prototype.action=function(t){return this.getAttribute("action")},t.prototype.setAction=function(t){return this.setAttribute("action",t),this}}),tag$.defineTag("h1"),tag$.defineTag("h2"),tag$.defineTag("h3"),tag$.defineTag("h4"),tag$.defineTag("h5"),tag$.defineTag("h6"),tag$.defineTag("head"),tag$.defineTag("header"),tag$.defineTag("hr"),tag$.defineTag("html"),tag$.defineTag("i"),tag$.defineTag("iframe",function(t){t.prototype.src=function(t){return this.getAttribute("src")},t.prototype.setSrc=function(t){return this.setAttribute("src",t),this}}),tag$.defineTag("img",function(t){t.prototype.src=function(t){return this.getAttribute("src")},t.prototype.setSrc=function(t){return this.setAttribute("src",t),this}}),tag$.defineTag("input",function(t){t.prototype.name=function(t){return this.getAttribute("name")},t.prototype.setName=function(t){return this.setAttribute("name",t),this},t.prototype.type=function(t){return this.getAttribute("type")},t.prototype.setType=function(t){return this.setAttribute("type",t),this},t.prototype.required=function(t){return this.getAttribute("required")},t.prototype.setRequired=function(t){return this.setAttribute("required",t),this},t.prototype.disabled=function(t){return this.getAttribute("disabled")},t.prototype.setDisabled=function(t){return this.setAttribute("disabled",t),this},t.prototype.autofocus=function(t){return this.getAttribute("autofocus")},t.prototype.setAutofocus=function(t){return this.setAttribute("autofocus",t),this},t.prototype.value=function(){return this.dom().value},t.prototype.setValue=function(t){return t!=this.dom().value&&(this.dom().value=t),this},t.prototype.setPlaceholder=function(t){return t!=this.dom().placeholder&&(this.dom().placeholder=t),this},t.prototype.placeholder=function(){return this.dom().placeholder},t.prototype.checked=function(){return this.dom().checked},t.prototype.setChecked=function(t){return t!=this.dom().checked&&(this.dom().checked=t),this}}),tag$.defineTag("ins"),tag$.defineTag("kbd"),tag$.defineTag("keygen"),tag$.defineTag("label"),tag$.defineTag("legend"),tag$.defineTag("li"),tag$.defineTag("link",function(t){t.prototype.rel=function(t){return this.getAttribute("rel")},t.prototype.setRel=function(t){return this.setAttribute("rel",t),this},t.prototype.type=function(t){return this.getAttribute("type")},t.prototype.setType=function(t){return this.setAttribute("type",t),this},t.prototype.href=function(t){return this.getAttribute("href")},t.prototype.setHref=function(t){return this.setAttribute("href",t),this},t.prototype.media=function(t){return this.getAttribute("media")},t.prototype.setMedia=function(t){return this.setAttribute("media",t),this}}),tag$.defineTag("main"),tag$.defineTag("map"),tag$.defineTag("mark"),tag$.defineTag("menu"),tag$.defineTag("menuitem"),tag$.defineTag("meta",function(t){t.prototype.name=function(t){return this.getAttribute("name")},t.prototype.setName=function(t){return this.setAttribute("name",t),this},t.prototype.content=function(t){return this.getAttribute("content")},t.prototype.setContent=function(t){return this.setAttribute("content",t),this},t.prototype.charset=function(t){return this.getAttribute("charset")},t.prototype.setCharset=function(t){return this.setAttribute("charset",t),this}}),tag$.defineTag("meter"),tag$.defineTag("nav"),tag$.defineTag("noscript"),tag$.defineTag("object"),tag$.defineTag("ol"),tag$.defineTag("optgroup"),tag$.defineTag("option",function(t){t.prototype.value=function(t){return this.getAttribute("value")},t.prototype.setValue=function(t){return this.setAttribute("value",t),this}}),tag$.defineTag("output"),tag$.defineTag("p"),tag$.defineTag("param"),tag$.defineTag("pre"),tag$.defineTag("progress"),tag$.defineTag("q"),tag$.defineTag("rp"),tag$.defineTag("rt"),tag$.defineTag("ruby"),tag$.defineTag("s"),tag$.defineTag("samp"),tag$.defineTag("script",function(t){t.prototype.src=function(t){return this.getAttribute("src")},t.prototype.setSrc=function(t){return this.setAttribute("src",t),this},t.prototype.type=function(t){return this.getAttribute("type")},t.prototype.setType=function(t){return this.setAttribute("type",t),this},t.prototype.async=function(t){return this.getAttribute("async")},t.prototype.setAsync=function(t){return this.setAttribute("async",t),this},t.prototype.defer=function(t){return this.getAttribute("defer")},t.prototype.setDefer=function(t){return this.setAttribute("defer",t),this}}),tag$.defineTag("section"),tag$.defineTag("select",function(t){t.prototype.name=function(t){return this.getAttribute("name")},t.prototype.setName=function(t){return this.setAttribute("name",t),this},t.prototype.multiple=function(t){return this.getAttribute("multiple")},t.prototype.setMultiple=function(t){return this.setAttribute("multiple",t),this},t.prototype.required=function(t){return this.getAttribute("required")},t.prototype.setRequired=function(t){return this.setAttribute("required",t),this},t.prototype.disabled=function(t){return this.getAttribute("disabled")},t.prototype.setDisabled=function(t){return this.setAttribute("disabled",t),this},t.prototype.value=function(){return this.dom().value},t.prototype.setValue=function(t){return t!=this.dom().value&&(this.dom().value=t),this}}),tag$.defineTag("small"),tag$.defineTag("source"),tag$.defineTag("span"),tag$.defineTag("strong"),tag$.defineTag("style"),tag$.defineTag("sub"),tag$.defineTag("summary"),tag$.defineTag("sup"),tag$.defineTag("table"),tag$.defineTag("tbody"),tag$.defineTag("td"),tag$.defineTag("textarea",function(t){t.prototype.name=function(t){return this.getAttribute("name")},t.prototype.setName=function(t){return this.setAttribute("name",t),this},t.prototype.disabled=function(t){return this.getAttribute("disabled")},t.prototype.setDisabled=function(t){return this.setAttribute("disabled",t),this},t.prototype.required=function(t){return this.getAttribute("required")},t.prototype.setRequired=function(t){return this.setAttribute("required",t),this},t.prototype.rows=function(t){return this.getAttribute("rows")},t.prototype.setRows=function(t){return this.setAttribute("rows",t),this},t.prototype.cols=function(t){return this.getAttribute("cols")},t.prototype.setCols=function(t){return this.setAttribute("cols",t),this},t.prototype.autofocus=function(t){return this.getAttribute("autofocus")},t.prototype.setAutofocus=function(t){return this.setAttribute("autofocus",t),this},t.prototype.value=function(){return this.dom().value},t.prototype.setValue=function(t){return t!=this.dom().value&&(this.dom().value=t),this},t.prototype.setPlaceholder=function(t){return t!=this.dom().placeholder&&(this.dom().placeholder=t),this},t.prototype.placeholder=function(){return this.dom().placeholder}}),tag$.defineTag("tfoot"),tag$.defineTag("th"),tag$.defineTag("thead"),tag$.defineTag("time"),tag$.defineTag("title"),tag$.defineTag("tr"),tag$.defineTag("track"),tag$.defineTag("u"),tag$.defineTag("ul"),tag$.defineTag("video"),tag$.defineTag("wbr")}()},function(t,e){!function(){function t(t){return t?t.toArray?t.toArray():t:[]}return Imba.document=function(){return window.document},Imba.root=function(){return tag$wrap(Imba.document().body)},tag$.defineTag("htmlelement","element",function(e){e.inherit=function(t){if(t.prototype._empty=!0,t._protoDom=null,!this._nodeType)return t._nodeType=t._name,t._classes=[];t._nodeType=this._nodeType;var e="_"+t._name.replace(/_/g,"-");return"#"!=t._name[0]?t._classes=this._classes.concat(e):void 0},e.buildNode=function(){var t=Imba.document().createElement(this._nodeType),e=this._classes.join(" ");return e&&(t.className=e),t},e.createNode=function(){var t=this._protoDom||(this._protoDom=this.buildNode());return t.cloneNode(!1)},e.dom=function(){return this._protoDom||(this._protoDom=this.buildNode())},e.prototype.id=function(t){return this.getAttribute("id")},e.prototype.setId=function(t){return this.setAttribute("id",t),this},e.prototype.tabindex=function(t){return this.getAttribute("tabindex")},e.prototype.setTabindex=function(t){return this.setAttribute("tabindex",t),this},e.prototype.title=function(t){return this.getAttribute("title")},e.prototype.setTitle=function(t){return this.setAttribute("title",t),this},e.prototype.role=function(t){return this.getAttribute("role")},e.prototype.setRole=function(t){return this.setAttribute("role",t),this},e.prototype.width=function(){return this._dom.offsetWidth},e.prototype.height=function(){return this._dom.offsetHeight},e.prototype.setChildren=function(t,e){return this._empty?this.append(t):this.empty().append(t),this._children=null,this},e.prototype.setHtml=function(t){return this._dom.innerHTML=t,this},e.prototype.html=function(){return this._dom.innerHTML},e.prototype.empty=function(){for(;this._dom.firstChild;)this._dom.removeChild(this._dom.firstChild);return this._children=null,this._empty=!0,this},e.prototype.remove=function(t){var e=this.dom(),n=t&&t.dom();return n&&n.parentNode==e&&e.removeChild(n),this},e.prototype.emit=function(t,e){e&&e.constructor===Object||(e={});var n=void 0!==e.data?e.data:null,o=void 0!==e.bubble?e.bubble:!0;return Imba.Events.trigger(t,this,{data:n,bubble:o}),this},e.prototype.dataset=function(e,n){if(e instanceof Object){for(var o=0,r=Object.keys(e),i=r.length;i>o;o++)this.dataset(r[o],e[r[o]]);return this}if(2==arguments.length)return this.setAttribute("data-"+e,n),this;if(e)return this.getAttribute("data-"+e);var a=this.dom().dataset;if(!a){a={};for(var s,o=0,u=t(this.dom().attributes),c=u.length;c>o;o++)s=u[o],"data-"==s.name.substr(0,5)&&(a[Imba.toCamelCase(s.name.slice(5))]=s.value)}return a},e.prototype.find=function(t){return new Imba.Selector(t,this)},e.prototype.first=function(t){return t?this.find(t).first():tag$wrap(this.dom().firstElementChild)},e.prototype.last=function(t){return t?this.find(t).last():tag$wrap(this.dom().lastElementChild)},e.prototype.child=function(t){return tag$wrap(this.dom().children[t||0])},e.prototype.children=function(t){var e=new Imba.Selector(null,this,this._dom.children);return t?e.filter(t):e},e.prototype.orphanize=function(){var t;return(t=this.dom().parentNode)&&t.removeChild(this._dom),this},e.prototype.matches=function(t){var e;return t instanceof Function?t(this):(t.query&&(t=t.query()),(e=this._dom.matches||this._dom.matchesSelector||this._dom.webkitMatchesSelector||this._dom.msMatchesSelector||this._dom.mozMatchesSelector)?e.call(this._dom,t):void 0)},e.prototype.closest=function(t){if(!t)return this.parent();var e=this;for(t.query&&(t=t.query());e;){if(e.matches(t))return e;e=e.parent()}return null},e.prototype.up=function(t){return t?this.parent()&&this.parent().closest(t):this.parent()},e.prototype.path=function(t){var e=this,n=[];for(t&&t.query&&(t=t.query());e;)(!t||e.matches(t))&&n.push(e),e=e.parent();return n},e.prototype.parents=function(t){var e=this.parent();return e?e.path(t):[]},e.prototype.siblings=function(t){var e,n=this;if(!(e=this.parent()))return[];var o=this.dom().parentNode.children,r=new Imba.Selector(null,this,o);return r.filter(function(e){return e!=n&&(!t||e.matches(t))})},e.prototype.next=function(t){if(t){for(var e=this;e=e.next();)if(e.matches(t))return e;return null}return tag$wrap(this.dom().nextElementSibling)},e.prototype.prev=function(t){if(t){for(var e=this;e=e.prev();)if(e.matches(t))return e;return null}return tag$wrap(this.dom().previousElementSibling)},e.prototype.contains=function(t){return this.dom().contains(t&&t._dom||t)},e.prototype.index=function(){for(var t=0,e=this.dom();e.previousSibling;)e=e.previousSibling,t++;return t},e.prototype.insert=function(t,e){e&&e.constructor===Object||(e={});var n=void 0!==e.before?e.before:null,o=void 0!==e.after?e.after:null;return o&&(n=o.next()),t instanceof Array&&(t=tag$.$fragment().setContent(t,0).end()),n?this.dom().insertBefore(t.dom(),n.dom()):this.append(t),this},e.prototype.focus=function(){return this.dom().focus(),this},e.prototype.blur=function(){return this.dom().blur(),this},e.prototype.template=function(){return null},e.prototype.prepend=function(t){var e=this._dom.childNodes[0];return e?this.insertBefore(t,e):this.appendChild(t),this},e.prototype.append=function(e){if(!e)return this;if(e instanceof Array)for(var n,o=0,r=t(e),i=r.length;i>o;o++)n=r[o],n&&this.append(n);else if("string"==typeof e||e instanceof String||"number"==typeof e||e instanceof Number){var a=Imba.document().createTextNode(e);this._dom.appendChild(a),this._empty&&(this._empty=!1)}else this._dom.appendChild(e._dom||e),this._empty&&(this._empty=!1);return this},e.prototype.insertBefore=function(t,e){return("string"==typeof t||t instanceof String)&&(t=Imba.document().createTextNode(t)),t&&e&&this.dom().insertBefore(t._dom||t,e._dom||e),this},e.prototype.appendChild=function(t){return("string"==typeof t||t instanceof String)&&(t=Imba.document().createTextNode(t)),t&&this.dom().appendChild(t._dom||t),this},e.prototype.removeChild=function(t){return t&&this.dom().removeChild(t._dom||t),this},e.prototype.toString=function(){return this._dom.toString()},e.prototype.classes=function(){return console.log("Imba.Tag#classes is deprecated"),this._dom.classList}}),tag$.defineTag("svgelement","htmlelement")}()},function(t,e){(function(t){!function(){function e(){}function n(t,e){this._classes=e||[],this._dom=t}function o(t){this.nodeName=t,this.classList=new n(this),this.children=[]}t.ImbaServerDocument=e,e.prototype.createElement=function(t){return new o(t)},e.prototype.createElementNS=function(t,e){return new o(e)},e.prototype.createTextNode=function(t){return t},Imba.document=function(){return this._document||(this._document=new e)},t.ImbaNodeClassList=n,n.prototype.add=function(t){return this._classes.indexOf(t)<0&&this._classes.push(t),this},n.prototype.remove=function(t){var e=this._classes.indexOf(t);return e>=0&&(this._classes[e]=""),this},n.prototype.toggle=function(t){return this},n.prototype.clone=function(t){var e=new n(t,this._classes.slice(0));return e},n.prototype.toString=function(){return this._classes.join(" ").trim()},t.ImbaServerElement=o,o.prototype.cloneNode=function(t){var e=new o(this.nodeName);return e.classList=this.classList.clone(this),e},o.prototype.appendChild=function(t){return this.children.push(t),
t},o.prototype.insertBefore=function(t,e){var n=this.children.indexOf(e);return this.arr().splice(n,0,t),this},o.prototype.setAttribute=function(t,e){return this._attributes||(this._attributes=[]),this._attributes.push(""+t+'="'+e+'"'),this._attributes[t]=e,this},o.prototype.getAttribute=function(t){return this._attributes?this._attributes[t]:void 0},o.prototype.removeAttribute=function(t){return console.log("removeAttribute not implemented on server"),!0},o.prototype.__innerHTML=function(){return this.innerHTML||this.textContent||this.children&&this.children.join("")||""},o.prototype.__outerHTML=function(){var t,e=this.nodeName,n=""+e;return(t=this.id)&&(n+=" id='"+t+"'"),(t=this.classList.toString())&&(n+=" class='"+t+"'"),(t=this._attributes)&&(n+=" "+this._attributes.join(" ")),"<"+n+">"+this.__innerHTML()+"</"+e+">"},o.prototype.toString=function(){return this._tag&&this._tag.toNodeString?this._tag.toNodeString():this.__outerHTML()};var r=o.prototype;return Object.defineProperty(r,"firstChild",{get:function(t){return this.children&&this.children[0]},enumerable:!0,configurable:!0}),Object.defineProperty(r,"firstElementChild",{get:function(t){return this.children&&this.children[0]},enumerable:!0,configurable:!0}),Object.defineProperty(r,"lastElementChild",{get:function(t){return this.children&&this.children[this.children.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(r,"className",{enumerable:!0,configurable:!0,get:function(){return this.classList.toString()},set:function(t){return this.classList._classes=(t||"").split(" "),this.classList.toString()}}),tag$.extendTag("htmlelement",function(t){t.prototype.toString=function(){return this.dom().toString()},t.prototype.empty=function(){return this._dom.children=[],this._dom.innerHTML=null,this._empty=!0,this},t.prototype.first=function(){return this._dom.children[0]},t.prototype.last=function(){return this._dom.children[this._dom.children.length-1]},t.prototype.prepend=function(t){return this._dom.children.unshift(t)}}),tag$.extendTag("html",function(t){t.prototype.doctype=function(){return this._doctype||"<!doctype html>"},t.prototype.toString=function(){return this.doctype()+t.__super__.toString.apply(this,arguments)}}),tag$.extendTag("style",function(t){t.prototype.toString=function(){return"<style/>"}}),t.document||(t.document=Imba.document())}()}).call(e,function(){return this}())},function(t,e){!function(){function t(t){return t?t.toArray?t.toArray():t:[]}function e(n,o,r){if(o instanceof u)n.removeChild(o);else if(o instanceof Array)for(var i=0,a=t(o),s=a.length;s>i;i++)e(n,a[i],r);else{var c=r?r.nextSibling:n._dom.firstChild;if(!(c instanceof Text&&c.textContent==o))throw"cannot remove string";n.removeChild(c)}return r}function n(e,o){if(o instanceof u)e.appendChild(o);else if(o instanceof Array)for(var r=0,i=t(o),a=i.length;a>r;r++)n(e,i[r]);else null!=o&&o!==!1&&e.appendChild(Imba.document().createTextNode(o))}function o(e,n,r){if(n instanceof u)e.insertBefore(n,r);else if(n instanceof Array)for(var i=0,a=t(n),s=a.length;s>i;i++)o(e,a[i],r);else null!=n&&n!==!1&&e.insertBefore(Imba.document().createTextNode(n),r);return r}function r(t,e,r){var i=r?r.nextSibling:t._dom.firstChild;return i?(o(t,e,i),i.previousSibling):(n(t,e),t._dom.lastChild)}function i(e,n,o,i){for(var a,s=n.length,u=n[s-1],c=[],l=[],h=[],p=0,f=0,d=0,m=t(o),g=m.length;g>d;d++){a=m[d];var b=n.indexOf(a);if(c.push(b),-1!=b){for(var y=c.length-2;y>=0;)if(-1==c[y])y--;else{if(b>c[y])break;y=l[y]}l.push(y);var v=-1==y?0:h[y]+1;v>p&&(p=v,f=d),h.push(v)}else e.removeChild(a),l.push(-1),h.push(-1)}for(var _=[],I=c.length-1;I>=0;)I==f&&-1!=c[I]&&(_[c[I]]=!0,f=l[f]),I-=1;for(var T=0,m=t(n),g=m.length;g>T;T++)if(!_[T]){var x=n[T-1];r(e,m[T],x&&x._dom||i)}return u&&u._dom||i}function a(t,e,n,o){var r=e.length,a=r,s=e[r-1];if(r==n.length&&e[0]===n[0])for(;a--&&e[a]===n[a];);return-1==a?s&&s._dom||o:i(t,e,n,o)}function s(n,o,i,c){var l=null==o||o===!1,h=null==i||i===!1;if(o===i)return l?c:o&&o._dom?o._dom:c?c.nextSibling:n._dom.firstChild;if(o instanceof Array){if(i instanceof Array){if(!o["static"]&&!i["static"])return a(n,o,i,c);if(o["static"]==i["static"]){for(var p=0,f=t(o),d=f.length;d>p;p++)c=s(n,f[p],i[p],c);return c}e(n,i,c)}else i instanceof u?n.removeChild(i):h||n.removeChild(c?c.nextSibling:n._dom.firstChild);return r(n,o,c)}if(o instanceof u)return h||e(n,i,c),r(n,o,c),o;if(l)return h||e(n,i,c),c;var m;if(i instanceof Array)e(n,i,c);else if(i instanceof u)n.removeChild(i);else if(!h&&(m=c?c.nextSibling:n._dom.firstChild,m instanceof Text&&m.textContent!=o))return m.textContent=o,m;return r(n,o,c)}var u=Imba.TAGS.element;return tag$.extendTag("htmlelement",function(e){e.prototype.setChildren=function(e,o){var r=this._children;if(e===r)return this;if(r){if(2==o)return this;if(1==o)for(var i=null,c=0,l=t(e),h=l.length;h>c;c++)i=s(this,l[c],r[c],i);else if(3==o)if(e instanceof u)this.empty(),this.appendChild(e);else{if(!(e instanceof Array))return this.setText(e),this;r instanceof Array?a(this,e,r,null):(this.empty(),n(this,e))}else e instanceof Array&&r instanceof Array?a(this,e,r,null):(this.empty(),n(this,e))}else this.empty(),n(this,e);return this._children=e,this},e.prototype.setStaticChildren=function(e){for(var n=this._children,o=null,r=0,i=t(e),a=i.length;a>r;r++)o=s(this,i[r],n[r],o);return this._children=e,this},e.prototype.content=function(){return this._content||this.children().toArray()},e.prototype.setText=function(t){return t!=this._children&&(this._children=t,this.dom().textContent=null==t||t===!1?"":t),this}})}()},function(t,e){!function(){function t(t,e){return e&&e.indexOf?e.indexOf(t):[].indexOf.call(t,e)}return tag$.SVG.defineTag("svgelement",function(e){e.namespaceURI=function(){return"http://www.w3.org/2000/svg"};var n="circle defs ellipse g line linearGradient mask path pattern polygon polyline radialGradient rect stop svg text tspan".split(" ");e.buildNode=function(){var t=Imba.document().createElementNS(this.namespaceURI(),this._nodeType),e=this._classes.join(" ");return e&&(t.className.baseVal=e),t},e.inherit=function(e){if(e._protoDom=null,t(e._name,n)>=0)return e._nodeType=e._name,e._classes=[];e._nodeType=this._nodeType;var o="_"+e._name.replace(/_/g,"-");return e._classes=this._classes.concat(o)},Imba.attr(e,"x"),Imba.attr(e,"y"),Imba.attr(e,"width"),Imba.attr(e,"height"),Imba.attr(e,"stroke"),Imba.attr(e,"stroke-width")}),tag$.SVG.defineTag("svg",function(t){Imba.attr(t,"viewbox")}),tag$.SVG.defineTag("g"),tag$.SVG.defineTag("defs"),tag$.SVG.defineTag("symbol",function(t){Imba.attr(t,"preserveAspectRatio"),Imba.attr(t,"viewBox")}),tag$.SVG.defineTag("marker",function(t){Imba.attr(t,"markerUnits"),Imba.attr(t,"refX"),Imba.attr(t,"refY"),Imba.attr(t,"markerWidth"),Imba.attr(t,"markerHeight"),Imba.attr(t,"orient")}),tag$.SVG.defineTag("rect",function(t){Imba.attr(t,"rx"),Imba.attr(t,"ry")}),tag$.SVG.defineTag("circle",function(t){Imba.attr(t,"cx"),Imba.attr(t,"cy"),Imba.attr(t,"r")}),tag$.SVG.defineTag("ellipse",function(t){Imba.attr(t,"cx"),Imba.attr(t,"cy"),Imba.attr(t,"rx"),Imba.attr(t,"ry")}),tag$.SVG.defineTag("path",function(t){Imba.attr(t,"d"),Imba.attr(t,"pathLength")}),tag$.SVG.defineTag("line",function(t){Imba.attr(t,"x1"),Imba.attr(t,"x2"),Imba.attr(t,"y1"),Imba.attr(t,"y2")}),tag$.SVG.defineTag("polyline",function(t){Imba.attr(t,"points")}),tag$.SVG.defineTag("polygon",function(t){Imba.attr(t,"points")}),tag$.SVG.defineTag("text",function(t){Imba.attr(t,"dx"),Imba.attr(t,"dy"),Imba.attr(t,"text-anchor"),Imba.attr(t,"rotate"),Imba.attr(t,"textLength"),Imba.attr(t,"lengthAdjust")}),tag$.SVG.defineTag("tspan",function(t){Imba.attr(t,"dx"),Imba.attr(t,"dy"),Imba.attr(t,"rotate"),Imba.attr(t,"textLength"),Imba.attr(t,"lengthAdjust")})}()},function(t,e){(function(t){!function(){"undefined"!=typeof window&&(t=window);var e="object"==typeof window&&this==window;Imba={VERSION:"0.14.3",CLIENT:e,SERVER:!e,DEBUG:!1};var n=/-./g;return Imba.isClient=function(){return 1==Imba.CLIENT},Imba.isServer=function(){return 1==Imba.SERVER},Imba.subclass=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t.prototype=Object.create(e.prototype),t.__super__=t.prototype.__super__=e.prototype,t.prototype.initialize=t.prototype.constructor=t,t},Imba.iterable=function(t){return t?t.toArray?t.toArray():t:[]},Imba.await=function(t){return t instanceof Array?Promise.all(t):t&&t.then?t:Promise.resolve(t)},Imba.toCamelCase=function(t){return t.replace(n,function(t){return t.charAt(1).toUpperCase()})},Imba.toCamelCase=function(t){return t.replace(n,function(t){return t.charAt(1).toUpperCase()})},Imba.indexOf=function(t,e){return e&&e.indexOf?e.indexOf(t):[].indexOf.call(t,e)},Imba.prop=function(t,e,n){return t.defineProperty?t.defineProperty(e,n):void 0},Imba.attr=function(t,e,n){if(t.defineAttribute)return t.defineAttribute(e,n);var o=Imba.toCamelCase(e),r=Imba.toCamelCase("set-"+e);t.prototype[o]=function(){return this.getAttribute(e)},t.prototype[r]=function(t){return this.setAttribute(e,t),this}}}()}).call(e,function(){return this}())},function(t,e,n){!function(){return"undefined"==typeof Imba?(n(43),n(35),n(45),n(47),n(39),n(38),n(42),Imba.SERVER&&n(40),Imba.CLIENT&&(n(36),n(37),n(41)),n(46)):console.warn("Imba v"+Imba.VERSION+" is already loaded")}()},function(t,e){(function(t){!function(){function e(t,e){return e&&e.indexOf?e.indexOf(t):[].indexOf.call(t,e)}var n;return n||(n=t.requestAnimationFrame),n||(n=t.webkitRequestAnimationFrame),n||(n=t.mozRequestAnimationFrame),n||(n=function(t){return setTimeout(t,1e3/60)}),Imba.tick=function(t){this._scheduled&&n(Imba.ticker()),Imba.Scheduler.willRun(),this.emit(this,"tick",[t]),Imba.Scheduler.didRun()},Imba.ticker=function(){var t=this;return t._ticker||(t._ticker=function(e){return t.tick(e)})},Imba.schedule=function(t,e){return void 0===e&&(e="tick"),this.listen(this,"tick",t,e),this._scheduled||(this._scheduled=!0,n(Imba.ticker())),this},Imba.unschedule=function(t,e){this.unlisten(this,"tick",t,e);var n=this.__listeners__||(this.__listeners__={});return n.tick&&n.tick.next&&n.tick.next.listener||(this._scheduled=!1),this},Imba.setTimeout=function(t,e){return setTimeout(function(){return e(),Imba.Scheduler.markDirty()},t)},Imba.setInterval=function(t,e){return setInterval(function(){return e(),Imba.Scheduler.markDirty()},t)},Imba.clearInterval=function(t){return clearInterval(t)},Imba.clearTimeout=function(t){return clearTimeout(t)},Imba.Scheduler=function(t){var e=this;e._target=t,e._marked=!1,e._active=!1,e._marker=function(){return e.mark()},e._ticker=function(t){return e.tick(t)},e._events=!0,e._fps=1,e._dt=0,e._timestamp=0,e._ticks=0,e._flushes=0},Imba.Scheduler.markDirty=function(){return this._dirty=!0,this},Imba.Scheduler.isDirty=function(){return!!this._dirty},Imba.Scheduler.willRun=function(){return this._active=!0},Imba.Scheduler.didRun=function(){return this._active=!1,this._dirty=!1},Imba.Scheduler.isActive=function(){return!!this._active},Imba.Scheduler.prototype.active=function(){return this._active},Imba.Scheduler.prototype.dt=function(){return this._dt},Imba.Scheduler.prototype.configure=function(t){t&&t.constructor===Object||(t={});var e=void 0!==t.fps?t.fps:1,n=void 0!==t.events?t.events:!0;return null!=n&&(this._events=n),null!=e&&(this._fps=e),this},Imba.Scheduler.prototype.mark=function(){return this._marked=!0,this},Imba.Scheduler.prototype.flush=function(){return this._marked=!1,this._flushes++,this._target.tick(),this},Imba.Scheduler.prototype.tick=function(t){this._ticks++,this._dt=t;var e=this._fps;if(60==e)this._marked=!0;else if(30==e)this._ticks%2&&(this._marked=!0);else if(e){var n=60/e/60*1e3,o=Math.floor(Date.now()/n);this._beat!=o&&(this._beat=o,this._marked=!0)}return(this._marked||this._events&&Imba.Scheduler.isDirty())&&this.flush(),this},Imba.Scheduler.prototype.activate=function(){return this._active||(this._active=!0,this._commit=this._target.commit,this._target.commit=function(){return this},Imba.schedule(this),this._events&&Imba.listen(Imba,"event",this,"onevent"),this._target&&this._target.flag&&this._target.flag("scheduled_"),this.tick(0)),this},Imba.Scheduler.prototype.deactivate=function(){return this._active&&(this._active=!1,this._target.commit=this._commit,Imba.unschedule(this),Imba.unlisten(Imba,"event",this),this._target&&this._target.unflag&&this._target.unflag("scheduled_")),this},Imba.Scheduler.prototype.track=function(){return this._marker},Imba.Scheduler.prototype.onevent=function(t){var n;return this._marked?this:(this._events instanceof Function?this._events(t)&&this.mark():this._events instanceof Array?e((n=t)&&n.type&&n.type(),this._events)>=0&&this.mark():this._events&&t._responder&&this.mark(),this)},Imba.Scheduler}()}).call(e,function(){return this}())},function(t,e){!function(){function t(t){return t?t.toArray?t.toArray():t:[]}return Imba.Selector=function(e,n,o){if(this._query=e instanceof Imba.Selector?e.query():e,this._context=n,o){for(var r=0,i=t(o),a=i.length,s=[];a>r;r++)s.push(tag$wrap(i[r]));this._nodes=s}return this._lazy=!o,this},Imba.Selector.one=function(t,e){var n=(e||Imba.document()).querySelector(t);return n&&tag$wrap(n)||null},Imba.Selector.all=function(t,e){return new Imba.Selector(t,e)},Imba.Selector.prototype.query=function(t){return this._query},Imba.Selector.prototype.setQuery=function(t){return this._query=t,this},Imba.Selector.prototype.reload=function(){return this._nodes=null,this},Imba.Selector.prototype.scope=function(){var t;return this._scope?this._scope:(t=this._context)?this._scope=t.toScope?t.toScope():t:Imba.document()},Imba.Selector.prototype.first=function(){return this._lazy?tag$wrap(this._first||(this._first=this.scope().querySelector(this.query()))):this.nodes()[0]},Imba.Selector.prototype.last=function(){return this.nodes()[this._nodes.length-1]},Imba.Selector.prototype.nodes=function(){if(this._nodes)return this._nodes;for(var e=this.scope().querySelectorAll(this.query()),n=0,o=t(e),r=o.length,i=[];r>n;n++)i.push(tag$wrap(o[n]));return this._nodes=i,this._lazy=!1,this._nodes},Imba.Selector.prototype.count=function(){return this.nodes().length},Imba.Selector.prototype.len=function(){return this.nodes().length},Imba.Selector.prototype.some=function(){return this.count()>=1},Imba.Selector.prototype.at=function(t){return this.nodes()[t]},Imba.Selector.prototype.forEach=function(t){return this.nodes().forEach(t),this},Imba.Selector.prototype.map=function(t){return this.nodes().map(t)},Imba.Selector.prototype.toArray=function(){return this.nodes()},Imba.Selector.prototype.closest=function(t){return this._nodes=this.map(function(e){return e.closest(t)}),this},Imba.Selector.prototype.siblings=function(t){return this._nodes=this.map(function(e){return e.siblings(t)}),this},Imba.Selector.prototype.find=function(t){return this._nodes=this.__query__(t.query(),this.nodes()),this},Imba.Selector.prototype.reject=function(t){return this.filter(t,!1)},Imba.Selector.prototype.filter=function(t,e){void 0===e&&(e=!0);var n=t instanceof Function&&t||function(e){return e.matches(t)},o=this.nodes().filter(function(t){return n(t)==e});return new Imba.Selector("",this._scope,o)},Imba.Selector.prototype.__query__=function(t,e){for(var n=[],o=0,r=e.length;r>o;)n.push.apply(n,e[o++].querySelectorAll(t));return n},Imba.Selector.prototype.__matches__=function(){return!0},Imba.Selector.prototype.flag=function(t){return this.forEach(function(e){return e.flag(t)})},Imba.Selector.prototype.unflag=function(t){return this.forEach(function(e){return e.unflag(t)})},q$=function(t,e){return new Imba.Selector(t,e)},q$$=function(t,e){var n=(e||Imba.document()).querySelector(t);return n&&tag$wrap(n)||null},tag$.extendTag("element",function(t){t.prototype.querySelectorAll=function(t){return this._dom.querySelectorAll(t)},t.prototype.querySelector=function(t){return this._dom.querySelector(t)},t.prototype.find=function(t){return new Imba.Selector(t,this)}})}()},function(t,e){!function(){function t(t,e){return e&&e.indexOf?e.indexOf(t):[].indexOf.call(t,e)}function e(t,e){for(var n=0,o=Object.keys(e),r=o.length;r>n;n++)null==t[$1=o[n]]?t[$1]=e[o[n]]:t[$1];return t.prototype=Object.create(e.prototype),t.__super__=t.prototype.__super__=e.prototype,t.prototype.initialize=t.prototype.constructor=t,e.inherit&&e.inherit(t),t}function n(){return function(t){return this.setDom(t),this}}function o(t){return function(){return t.build()}}Imba["static"]=function(t,e){return t["static"]=e,t},Imba.Tag=function(t){this.setDom(t)},Imba.Tag.createNode=function(){throw"Not implemented"},Imba.Tag.build=function(){return new this(this.createNode())},Imba.Tag.prototype.object=function(t){return this._object},Imba.Tag.prototype.setObject=function(t){return this._object=t,this},Imba.Tag.prototype.dom=function(){return this._dom},Imba.Tag.prototype.setDom=function(t){return t._tag=this,this._dom=t,this},Imba.Tag.prototype.setRef=function(t,e){return this.flag(this._ref=t),this},Imba.Tag.prototype.setHandler=function(t,e,n){var o="on"+t;if(e instanceof Function)this[o]=e;else if(e instanceof Array){var r=e.shift();this[o]=function(t){return n[r].apply(n,e.concat(t))}}else this[o]=function(t){return n[e](t)};return this},Imba.Tag.prototype.setId=function(t){return this.dom().id=t,this},Imba.Tag.prototype.id=function(){return this.dom().id},Imba.Tag.prototype.setAttribute=function(t,e){var n=this.dom().getAttribute(t);return n==e?e:null!=e&&e!==!1?this.dom().setAttribute(t,e):this.dom().removeAttribute(t)},Imba.Tag.prototype.removeAttribute=function(t){return this.dom().removeAttribute(t)},Imba.Tag.prototype.getAttribute=function(t){return this.dom().getAttribute(t)},Imba.Tag.prototype.setContent=function(t,e){return this.setChildren(t,e),this},Imba.Tag.prototype.setChildren=function(t,e){throw"Not implemented"},Imba.Tag.prototype.text=function(t){return this._dom.textContent},Imba.Tag.prototype.setText=function(t){return this._empty=!1,this._dom.textContent=null==t?t="":t,this},Imba.Tag.prototype.dataset=function(t,e){throw"Not implemented"},Imba.Tag.prototype.render=function(){return this},Imba.Tag.prototype.build=function(){return this.render(),this},Imba.Tag.prototype.commit=function(){return this.render(),this},Imba.Tag.prototype.tick=function(){return this.render(),this},Imba.Tag.prototype.end=function(){return this._built?this.commit():(this._built=!0,this.build()),this},Imba.Tag.prototype.synced=function(){return this},Imba.Tag.prototype.awaken=function(){return this},Imba.Tag.prototype.flags=function(){return this._dom.classList},Imba.Tag.prototype.flag=function(t,e){return 2!=arguments.length||e?this._dom.classList.add(t):this._dom.classList.remove(t),this},Imba.Tag.prototype.unflag=function(t){return this._dom.classList.remove(t),this},Imba.Tag.prototype.toggleFlag=function(t){return this._dom.classList.toggle(t),this},Imba.Tag.prototype.hasFlag=function(t){return this._dom.classList.contains(t)},Imba.Tag.prototype.scheduler=function(){return null==this._scheduler?this._scheduler=new Imba.Scheduler(this):this._scheduler},Imba.Tag.prototype.schedule=function(t){return void 0===t&&(t={}),this.scheduler().configure(t).activate(),this},Imba.Tag.prototype.unschedule=function(){return this._scheduler&&this.scheduler().deactivate(),this},Imba.Tag.prototype.parent=function(){return tag$wrap(this.dom().parentNode)},Imba.Tag.prototype.log=function(){for(var t=arguments,e=t.length,n=new Array(e>0?e:0);e>0;)n[e-1]=t[--e];return n.unshift(console),Function.prototype.call.apply(console.log,n),this},Imba.Tag.prototype.css=function(t,e){if(t instanceof Object)for(var n=0,o=Object.keys(t),r=o.length;r>n;n++)this.css(o[n],t[o[n]]);else if(null==e)this.dom().style.removeProperty(t);else{if(void 0==e)return this.dom().style[t];("number"==typeof e||e instanceof Number)&&t.match(/width|height|left|right|top|bottom/)&&(e+="px"),this.dom().style[t]=e}return this},Imba.Tag.prototype.setTransform=function(t){return this.css("transform",t),this},Imba.Tag.prototype.transform=function(){return this.css("transform")},Imba.Tag.prototype.initialize=Imba.Tag,HTML_TAGS="a abbr address area article aside audio b base bdi bdo big blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hr html i iframe img input ins kbd keygen label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td textarea tfoot th thead time title tr track u ul var video wbr".split(" "),HTML_TAGS_UNSAFE="article aside header section".split(" "),SVG_TAGS="circle defs ellipse g line linearGradient mask path pattern polygon polyline radialGradient rect stop svg text tspan".split(" "),Imba.Tags=function(){},Imba.Tags.prototype.__clone=function(t){var e=Object.create(this);return e._parent=this,e},Imba.Tags.prototype.defineNamespace=function(t){var e=Object.create(this);return e._parent=this,e._ns=t,this[t.toUpperCase()]=e,e},Imba.Tags.prototype.baseType=function(e){return t(e,HTML_TAGS)>=0?"htmlelement":"div"},Imba.Tags.prototype.defineTag=function(t,r,i){void 0==i&&"function"==typeof r&&(i=r,r=""),void 0==r&&(r=""),r||(r=this.baseType(t));var a=this[r],s=n(),u=t.replace(/\-/g,"_");return s._name=t,e(s,a),"#"==t[0]?(this[t]=s,Imba.SINGLETONS[t.slice(1)]=s):(this[t]=s,this["$"+u]=o(s)),i&&(2==i.length&&(s.hasOwnProperty("TAGS")||(s.TAGS=(a.TAGS||this).__clone())),i.call(s,s,s.TAGS||this)),s},Imba.Tags.prototype.defineSingleton=function(t,e,n){return this.defineTag(t,e,n)},Imba.Tags.prototype.extendTag=function(t,e,n){void 0==n&&"function"==typeof e&&(n=e,e=""),void 0==e&&(e="");var o="string"==typeof t||t instanceof String?this[t]:t;return n&&n&&n.call(o,o,o.prototype),o},Imba.TAGS=new Imba.Tags,Imba.TAGS.element=Imba.Tag;var r=Imba.TAGS.defineNamespace("svg");r.baseType=function(t){return"svgelement"},Imba.SINGLETONS={},Imba.defineTag=function(t,e,n){return void 0==n&&"function"==typeof e&&(n=e,e=""),void 0==e&&(e=""),Imba.TAGS.defineTag(t,e,n)},Imba.defineSingletonTag=function(t,e,n){return void 0==n&&"function"==typeof e&&(n=e,e="div"),void 0==e&&(e="div"),Imba.TAGS.defineTag(this.name(),e,n)},Imba.extendTag=function(t,e){return Imba.TAGS.extendTag(t,e)},Imba.tag=function(t){var e=Imba.TAGS[t];if(!e)throw new Error("tag "+t+" is not defined");return new e(e.createNode())},Imba.tagWithId=function(t,e){var n=Imba.TAGS[t];if(!n)throw new Error("tag "+t+" is not defined");var o=n.createNode();return o.id=e,new n(o)},Imba.getTagSingleton=function(t){var e,n,o;return(e=Imba.SINGLETONS[t])?e&&e.Instance?e.Instance:(n=Imba.document().getElementById(t))?(o=e.Instance=new e(n),o.awaken(n),o):(n=e.createNode(),n.id=t,o=e.Instance=new e(n),o.end().awaken(n),o):(n=Imba.document().getElementById(t))?Imba.getTagForDom(n):void 0};var i="undefined"!=typeof SVGElement;return Imba.getTagForDom=function(t){var e;if(!t)return null;if(t._dom)return t;if(t._tag)return t._tag;if(!t.nodeName)return null;var n=null,o=t.id,r=t.nodeName.toLowerCase(),a=Imba.TAGS,s=r,u=t.className;if(o&&Imba.SINGLETONS[o])return Imba.getTagSingleton(o);i&&t instanceof SVGElement&&(n="svg",u=t.className.baseVal,a=a.SVG);var c;return u&&((e=u.match(/\b_([a-z\-]+)\b(?!\s*_[a-z\-]+)/))&&(r=e[1]),(e=u.match(/\b([A-Z\-]+)_\b/))&&(n=e[1])),c=a[r]||a[s],c?new c(t).awaken(t):null},tag$=Imba.TAGS,t$=Imba.tag,tc$=Imba.tagWithFlags,ti$=Imba.tagWithId,tic$=Imba.tagWithIdAndFlags,id$=Imba.getTagSingleton,tag$wrap=Imba.getTagForDom}()},function(t,e,n){var o=n(27);"string"==typeof o&&(o=[[t.id,o,""]]),n(6)(o,{}),o.locals&&(t.exports=o.locals)},function(t,e,n){var o=n(28);"string"==typeof o&&(o=[[t.id,o,""]]),n(6)(o,{}),o.locals&&(t.exports=o.locals)}]);